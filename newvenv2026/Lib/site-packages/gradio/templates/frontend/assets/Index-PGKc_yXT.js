import"./svelte/svelte_internal_flags_async.js";import*as r from"./svelte/svelte_internal_client.js";import{tick as U}from"./svelte/svelte_svelte.js";import{B as k,U as z}from"./IconButtonWrapper-D4LMIc_2.js";import"./svelte/svelte_internal_flags_legacy.js";import"./i18n-CyvX8KmK.js";import{G as A}from"./utils.svelte-Ceck75cM.js";import C from"./Gallery-BZ8plrIl.js";import{S as P}from"./StreamingBar-C6ky6DsM.js";import{BaseFileUpload as j}from"./Index-C5wj12UG.js";import{default as _e}from"./Example-CR6Oggaq.js";import"./MarkdownCode-C7jLnxqj.js";import"./index-Dw8Uzof1.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_motion.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_store.js";import"./svelte/svelte_transition.js";import"./svelte/svelte_events.js";import"./prism-python-B1e-54E9.js";import"./ShareButton-DGzDjeX1.js";import"./FullscreenButton-CdZP1GYm.js";import"./ModifyUpload-2md6CVWe.js";import"./Image-Bdf4wQSw.js";import"./ImagePreview-CBoeGuoF.js";import"./Video-06U9X4-1.js";import"./index-tFQomdd2.js";import"./Example-C86RGnmZ.js";var F=r.from_html("<!> <!>",1);function he(_,m){r.push(m,!0);let n=r.state(void 0);class f extends A{async get_data(){return r.get(n)&&(await r.get(n),await U()),await super.get_data()}}const v=r.rest_props(m,["$$slots","$$events","$$legacy"]),e=new f(v);let d=r.state(!1),w=r.derived(()=>e.props.value===null?!0:e.props.value.length===0);function y(o){if(!e.props.value)return;const{index:l}=o.detail;e.dispatch("delete",o.detail),e.props.value=e.props.value.filter((a,p)=>p!==l),e.dispatch("change",e.props.value)}async function g(o){return(await Promise.all(o.map(async a=>{if(a.path?.toLowerCase().endsWith(".svg")&&a.url){const u=await(await fetch(a.url)).text();return{...a,url:`data:image/svg+xml,${encodeURIComponent(u)}`}}return a}))).map(a=>a.mime_type?.includes("video")?{video:a,caption:null}:{image:a,caption:null})}{let o=r.derived(()=>typeof e.props.height=="number"?e.props.height:void 0);k(_,{get visible(){return e.shared.visible},variant:"solid",padding:!1,get elem_id(){return e.shared.elem_id},get elem_classes(){return e.shared.elem_classes},get container(){return e.shared.container},get scale(){return e.shared.scale},get min_width(){return e.shared.min_width},allow_overflow:!1,get height(){return r.get(o)},get fullscreen(){return r.get(d)},set fullscreen(l){r.set(d,l,!0)},children:(l,a)=>{var p=F(),u=r.first_child(p);P(u,r.spread_props({get autoscroll(){return e.shared.autoscroll},get i18n(){return e.i18n}},()=>e.shared.loading_status,{on_clear_status:()=>e.dispatch("clear_status",e.shared.loading_status)}));var $=r.sibling(u,2);{var b=i=>{j(i,{value:null,get root(){return e.shared.root},get label(){return e.shared.label},get max_file_size(){return e.shared.max_file_size},file_count:"multiple",get file_types(){return e.props.file_types},get i18n(){return e.i18n},upload:(...s)=>e.shared.client.upload(...s),stream_handler:(...s)=>e.shared.client.stream(...s),get upload_promise(){return r.get(n)},set upload_promise(s){r.set(n,s,!0)},$$events:{upload:async s=>{const c=Array.isArray(s.detail)?s.detail:[s.detail];e.props.value=await g(c),e.dispatch("upload",e.props.value),e.dispatch("change",e.props.value)},error:({detail:s})=>{e.shared.loading_status=e.shared.loading_status||{},e.shared.loading_status.status="error",e.dispatch("error",s)}},children:(s,c)=>{z(s,{get i18n(){return e.i18n},type:"gallery"})},$$slots:{default:!0}})},x=i=>{{let s=r.derived(()=>e.props.buttons.some(t=>typeof t=="string"&&t==="share")),c=r.derived(()=>e.props.buttons.some(t=>typeof t=="string"&&t==="download")),G=r.derived(()=>e.props.buttons.some(t=>typeof t=="string"&&t==="fullscreen"));C(i,{get label(){return e.shared.label},get show_label(){return e.shared.show_label},get columns(){return e.props.columns},get rows(){return e.props.rows},get height(){return e.props.height},get preview(){return e.props.preview},get object_fit(){return e.props.object_fit},get interactive(){return e.shared.interactive},get allow_preview(){return e.props.allow_preview},get show_share_button(){return r.get(s)},get show_download_button(){return r.get(c)},get fit_columns(){return e.props.fit_columns},get i18n(){return e.i18n},_fetch:(...t)=>e.shared.client.fetch(...t),get show_fullscreen_button(){return r.get(G)},get buttons(){return e.props.buttons},on_custom_button_click:t=>{e.dispatch("custom_button_click",{id:t})},get fullscreen(){return r.get(d)},get root(){return e.shared.root},get file_types(){return e.props.file_types},get max_file_size(){return e.shared.max_file_size},upload:(...t)=>e.shared.client.upload(...t),stream_handler:(...t)=>e.shared.client.stream(...t),get selected_index(){return e.props.selected_index},set selected_index(t){e.props.selected_index=t},get value(){return e.props.value},set value(t){e.props.value=t},$$events:{change:()=>e.dispatch("change"),clear:()=>e.dispatch("change"),select:t=>e.dispatch("select",t.detail),share:t=>e.dispatch("share",t.detail),error:t=>e.dispatch("error",t.detail),preview_open:()=>e.dispatch("preview_open"),preview_close:()=>e.dispatch("preview_close"),fullscreen:({detail:t})=>{r.set(d,t,!0)},delete:y,upload:async t=>{const B=Array.isArray(t.detail)?t.detail:[t.detail],h=await g(B);e.props.value=e.props.value?[...e.props.value,...h]:h,e.dispatch("upload",h),e.dispatch("change",e.props.value)}}})}};r.if($,i=>{e.shared.interactive&&r.get(w)?i(b):i(x,!1)})}r.append(l,p)},$$slots:{default:!0}})}r.pop()}export{_e as BaseExample,C as BaseGallery,he as default};
