import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import"./i18n-CyvX8KmK.js";import{G as se}from"./utils.svelte-Ceck75cM.js";import{e as Z,R as Y,y as $,c as ae,B as ne}from"./IconButtonWrapper-D4LMIc_2.js";import"./svelte/svelte_internal_flags_legacy.js";import{createEventDispatcher as oe,tick as ie}from"./svelte/svelte_svelte.js";import{fly as ue}from"./svelte/svelte_transition.js";import{S as de}from"./StreamingBar-C6ky6DsM.js";import{default as Ye}from"./Example-Ctdnw0MA.js";import"./svelte/svelte_store.js";import"./index-Dw8Uzof1.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_motion.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_events.js";import"./MarkdownCode-C7jLnxqj.js";import"./prism-python-B1e-54E9.js";var ce=e.from_html('<li data-testid="dropdown-option" role="option"><span>âœ“</span> </li>'),_e=e.from_html('<ul class="options svelte-1ou0lab" role="listbox"></ul>'),pe=e.from_html('<div class="reference"></div> <!>',1);function ee(y,l){e.push(l,!1);let t=e.prop(l,"choices",12),s=e.prop(l,"filtered_indices",12),u=e.prop(l,"show_options",12,!1),_=e.prop(l,"disabled",12,!1),p=e.prop(l,"selected_indices",28,()=>[]),D=e.prop(l,"active_index",12,null),T=e.prop(l,"remember_scroll",12,!1),B=e.prop(l,"offset_from_top",12,0),C=e.prop(l,"from_top",12,!1),w=e.mutable_source(),m=e.mutable_source(),E=e.mutable_source(),R=e.mutable_source(),n=e.mutable_source(),x=e.mutable_source(),O=e.mutable_source(),G=e.mutable_source(),U=e.mutable_source(),f=e.mutable_source(),h=e.mutable_source(0);function q(){const{top:a,bottom:c}=e.get(n).getBoundingClientRect();C()?e.set(w,B()):e.set(w,a),e.set(m,e.get(f)-c)}let W=null;function j(){u()&&(W!==null&&clearTimeout(W),W=setTimeout(()=>{q(),W=null},10))}function I(){e.get(x)?.scrollTo?.(0,e.get(h))}const k=oe();e.legacy_pre_effect(()=>(e.deep_read_state(u()),e.get(n),e.deep_read_state(T()),e.get(x),e.deep_read_state(p()),e.get(E),e.get(m),e.get(w),e.deep_read_state(C())),()=>{if(u()&&e.get(n)){if(T())I();else if(e.get(x)&&p().length>0){let c=e.get(x).querySelectorAll("li");for(const P of Array.from(c))if(P.getAttribute("data-index")===p()[0].toString()){e.get(x)?.scrollTo?.(0,P.offsetTop);break}}q();const a=e.get(n).parentElement?.getBoundingClientRect();e.set(E,a?.height||0),e.set(R,a?.width||0)}e.get(m)>e.get(w)||C()?(e.set(O,`${e.get(w)}px`),e.set(U,e.get(m)),e.set(G,null)):(e.set(G,`${e.get(m)+e.get(E)}px`),e.set(U,e.get(w)-e.get(E)),e.set(O,null))}),e.legacy_pre_effect_reset();var Q={get choices(){return t()},set choices(a){t(a),e.flush()},get filtered_indices(){return s()},set filtered_indices(a){s(a),e.flush()},get show_options(){return u()},set show_options(a){u(a),e.flush()},get disabled(){return _()},set disabled(a){_(a),e.flush()},get selected_indices(){return p()},set selected_indices(a){p(a),e.flush()},get active_index(){return D()},set active_index(a){D(a),e.flush()},get remember_scroll(){return T()},set remember_scroll(a){T(a),e.flush()},get offset_from_top(){return B()},set offset_from_top(a){B(a),e.flush()},get from_top(){return C()},set from_top(a){C(a),e.flush()}};e.init();var F=pe();e.event("scroll",e.window,j);var H=e.first_child(F);e.bind_this(H,a=>e.set(n,a),()=>e.get(n));var V=e.sibling(H,2);{var J=a=>{var c=_e();let P;e.each(c,5,s,e.index,(z,A)=>{var S=ce();let r,i;var b=e.child(S);let v;var L=e.sibling(b);e.reset(S),e.template_effect((K,N,M)=>{r=e.set_class(S,1,"item svelte-1ou0lab",null,r,K),e.set_attribute(S,"data-index",e.get(A)),e.set_attribute(S,"aria-label",(e.deep_read_state(t()),e.get(A),e.untrack(()=>t()[e.get(A)][0]))),e.set_attribute(S,"aria-selected",N),i=e.set_style(S,"",i,{width:e.get(R)+"px"}),v=e.set_class(b,1,"inner-item svelte-1ou0lab",null,v,M),e.set_text(L,` ${e.deep_read_state(t()),e.get(A),e.untrack(()=>t()[e.get(A)][0])??""}`)},[()=>({selected:p().includes(e.get(A)),active:e.get(A)===D(),"bg-gray-100":e.get(A)===D(),"dark:bg-gray-600":e.get(A)===D()}),()=>(e.deep_read_state(p()),e.get(A),e.untrack(()=>p().includes(e.get(A)))),()=>({hide:!p().includes(e.get(A))})]),e.append(z,S)}),e.reset(c),e.bind_this(c,z=>e.set(x,z),()=>e.get(x)),e.template_effect(()=>P=e.set_style(c,"",P,{top:e.get(O),bottom:e.get(G),"max-height":`calc(${e.get(U)}px - var(--window-padding))`,width:e.get(R)+"px"})),e.transition(3,c,()=>ue,()=>({duration:200,y:5})),e.event("mousedown",c,e.preventDefault(z=>k("change",z))),e.event("scroll",c,z=>e.set(h,z.currentTarget.scrollTop)),e.append(a,c)};e.if(V,a=>{u()&&!_()&&a(J)})}return e.bind_window_size("innerHeight",a=>e.set(f,a)),e.append(y,F),e.pop(Q)}function ge(y,l){return(y%l+l)%l}function te(y,l){return y.reduce((t,s,u)=>((!l||s[0].toLowerCase().includes(l.toLowerCase()))&&t.push(u),t),[])}function re(y,l,t){if(y.key==="Escape")return[!1,l];if((y.key==="ArrowDown"||y.key==="ArrowUp")&&t.length>0)if(l===null)l=y.key==="ArrowDown"?t[0]:t[t.length-1];else{const s=t.indexOf(l),u=y.key==="ArrowUp"?-1:1;l=t[ge(s+u,t.length)]}return[!0,l]}var fe=e.from_html('<div class="token-remove svelte-1dv2vbb" role="button" tabindex="0"><!></div>'),ve=e.from_html('<div class="token svelte-1dv2vbb"><span class="svelte-1dv2vbb"><!></span> <!></div>'),me=e.from_html('<div role="button" tabindex="0" class="token-remove remove-all svelte-1dv2vbb"><!></div>'),he=e.from_html('<!> <span class="icon-wrap svelte-1dv2vbb"><!></span>',1),be=e.from_html('<label><!> <div class="wrap svelte-1dv2vbb"><div><!> <div class="secondary-wrap svelte-1dv2vbb"><input autocomplete="off"/> <!></div></div> <!></div></label>');function we(y,l){e.push(l,!0),e.rest_props(l,["$$slots","$$events","$$legacy"]);const t=l.gradio;let s,u=e.state(""),_=e.derived(()=>t.shared.label||"Multiselect"),p=e.derived(()=>t.props.choices.map(r=>r[0])),D=e.derived(()=>t.props.choices.map(r=>r[1])),T=e.derived(()=>!t.shared.interactive),B=e.state(!1),C=e.derived(()=>{const r=te(t.props.choices,e.get(u));return[r,r.length>0&&!t.props.allow_custom_value?r[0]:null]}),w=e.derived(()=>e.to_array(e.get(C),2)),m=e.derived(()=>e.get(w)[0]),E=e.derived(()=>e.get(w)[1]);function R(){return t.props.value===void 0?[]:Array.isArray(t.props.value)?t.props.value.map(r=>{const i=e.get(D).indexOf(r);if(i!==-1)return i;if(t.props.allow_custom_value)return r}).filter(r=>r!==void 0):[]}let n=e.derived(R);function x(){t.props.allow_custom_value||e.set(u,""),t.props.allow_custom_value&&e.get(u)!==""&&(G(e.get(u)),e.set(u,"")),t.dispatch("blur"),e.set(B,!1),e.set(E,null)}function O(r){e.set(n,e.get(n).filter(i=>i!==r)),t.props.value=e.get(n).map(i=>typeof i=="number"?e.get(D)[i]:i),t.dispatch("input"),t.dispatch("select",{index:typeof r=="number"?r:-1,value:typeof r=="number"?e.get(D)[r]:r,selected:!1})}function G(r){(t.props.max_choices==null||e.get(n).length<t.props.max_choices)&&(e.get(n).push(r),t.dispatch("select",{index:typeof r=="number"?r:-1,value:typeof r=="number"?e.get(D)[r]:r,selected:!0})),e.get(n).length===t.props.max_choices&&(e.set(B,!1),e.set(E,null),s.blur()),t.props.value=e.get(n).map(i=>typeof i=="number"?e.get(D)[i]:i)}function U(r){const i=parseInt(r.detail.target.dataset.index);f(i)}function f(r){e.get(n).includes(r)?O(r):G(r),e.set(u,""),e.set(E,null),t.dispatch("input")}function h(r){e.set(n,[]),e.set(u,""),t.props.value=[],r.preventDefault()}function q(r){e.set(m,t.props.choices.map((i,b)=>b)),(t.props.max_choices===null||e.get(n).length<t.props.max_choices)&&e.set(B,!0),t.dispatch("focus"),e.set(B,!0)}function W(r){(i=>{var b=e.to_array(i,2);e.set(B,b[0],!0),e.set(E,b[1])})(re(r,e.get(E),e.get(m))),r.key==="Enter"&&(e.get(E)!==null?f(e.get(E)):t.props.allow_custom_value&&(G(e.get(u)),e.set(u,""))),r.key==="Backspace"&&e.get(u)===""&&e.set(n,[...e.get(n).slice(0,-1)]),e.get(n).length===t.props.max_choices&&(e.set(B,!1),e.set(E,null))}let j=e.state(e.proxy(t.props.value));e.user_effect(()=>{e.get(j)!==t.props.value&&(e.set(j,t.props.value,!0),t.dispatch("change"))});var I=be();let k;var Q=e.child(I);Z(Q,{get show_label(){return t.shared.show_label},get info(){return t.props.info},children:(r,i)=>{e.next();var b=e.text();e.template_effect(()=>e.set_text(b,e.get(_))),e.append(r,b)},$$slots:{default:!0}});var F=e.sibling(Q,2),H=e.child(F);let V;var J=e.child(H);e.each(J,17,()=>e.get(n),e.index,(r,i)=>{var b=ve(),v=e.child(b),L=e.child(v);{var K=d=>{var g=e.text();e.template_effect(()=>e.set_text(g,e.get(p)[e.get(i)])),e.append(d,g)},N=d=>{var g=e.text();e.template_effect(()=>e.set_text(g,e.get(i))),e.append(d,g)};e.if(L,d=>{typeof e.get(i)=="number"?d(K):d(N,!1)})}e.reset(v);var M=e.sibling(v,2);{var o=d=>{var g=fe(),le=e.child(g);Y(le),e.reset(g),e.template_effect(X=>e.set_attribute(g,"title",X),[()=>t.i18n("common.remove")+" "+e.get(i)]),e.event("click",g,e.preventDefault(()=>O(e.get(i)))),e.event("keydown",g,X=>{X.key==="Enter"&&O(e.get(i))}),e.append(d,g)};e.if(M,d=>{e.get(T)||d(o)})}e.reset(b),e.append(r,b)});var a=e.sibling(J,2),c=e.child(a);e.remove_input_defaults(c);let P;e.bind_this(c,r=>s=r,()=>s);var z=e.sibling(c,2);{var A=r=>{var i=he(),b=e.first_child(i);{var v=N=>{var M=me(),o=e.child(M);Y(o),e.reset(M),e.template_effect(d=>e.set_attribute(M,"title",d),[()=>t.i18n("common.clear")]),e.event("click",M,h),e.event("keydown",M,d=>{d.key==="Enter"&&h(d)}),e.append(N,M)};e.if(b,N=>{e.get(n).length>0&&N(v)})}var L=e.sibling(b,2),K=e.child(L);$(K),e.reset(L),e.append(r,i)};e.if(z,r=>{e.get(T)||r(A)})}e.reset(a),e.reset(H);var S=e.sibling(H,2);ee(S,{get show_options(){return e.get(B)},get choices(){return t.props.choices},get filtered_indices(){return e.get(m)},get disabled(){return e.get(T)},get selected_indices(){return e.get(n)},get active_index(){return e.get(E)},remember_scroll:!0,$$events:{change:U}}),e.reset(F),e.reset(I),e.template_effect(r=>{k=e.set_class(I,1,"svelte-1dv2vbb",null,k,{container:t.shared.container}),V=e.set_class(H,1,"wrap-inner svelte-1dv2vbb",null,V,{show_options:e.get(B)}),P=e.set_class(c,1,"border-none svelte-1dv2vbb",null,P,r),c.disabled=e.get(T),c.readOnly=!t.props.filterable},[()=>({subdued:!e.get(p).includes(e.get(u))&&!t.props.allow_custom_value||e.get(n).length===t.props.max_choices})]),e.bind_value(c,()=>e.get(u),r=>e.set(u,r)),e.event("keydown",c,W),e.event("keyup",c,r=>{t.dispatch("key_up",{key:r.key,input_value:e.get(u)})}),e.event("blur",c,x),e.event("focus",c,q),e.append(y,I),e.pop()}var ye=e.from_html('<div class="icon-wrap svelte-1xfsv4t"><!></div>'),xe=e.from_html('<div><!> <!> <div class="wrap svelte-1xfsv4t"><div><div class="secondary-wrap svelte-1xfsv4t"><input role="listbox" aria-controls="dropdown-options" autocomplete="off"/> <!></div></div> <!></div></div>');function ke(y,l){e.push(l,!0);const t=typeof window<"u";let s=e.prop(l,"label",3,"Dropdown"),u=e.prop(l,"info",3,void 0),_=e.prop(l,"value",15),p=e.prop(l,"choices",19,()=>[]),D=e.prop(l,"interactive",3,!0),T=e.prop(l,"show_label",3,!0),B=e.prop(l,"container",3,!0),C=e.prop(l,"allow_custom_value",3,!1),w=e.prop(l,"filterable",3,!0),m=e.prop(l,"buttons",3,null),E=e.prop(l,"on_custom_button_click",3,null),R,n=e.derived(()=>t&&R===document.activeElement),x=e.derived(()=>p().map(o=>o[0])),O=e.derived(()=>p().map(o=>o[1])),G=e.derived(()=>_()===void 0||_()===null||Array.isArray(_())&&_().length===0?["",null]:e.get(O).includes(_())?[e.get(x)[e.get(O).indexOf(_())],e.get(O).indexOf(_())]:C()?[_(),null]:["",null]),U=e.derived(()=>e.to_array(e.get(G),2)),f=e.derived(()=>e.get(U)[0]),h=e.derived(()=>e.get(U)[1]),q=e.get(f),W=e.state(!1),j=e.derived(()=>!D()),I=e.state(e.proxy(p().map((o,d)=>d))),k=e.state(null);function Q(o){if(e.set(h,parseInt(o.detail.target.dataset.index)),isNaN(e.get(h))){e.set(h,null);return}let[d,g]=p()[e.get(h)];e.set(f,d),q=e.get(f),_(g),l.on_select?.({index:e.get(h),value:e.get(O)[e.get(h)],selected:!0}),e.set(n,!1),e.set(k,null),l.on_input?.(),R.blur()}function F(o){e.set(I,p().map((d,g)=>g),!0),e.set(n,!0),l.on_focus?.()}function H(){C()?e.get(x).includes(e.get(f))?(e.set(h,e.get(x).indexOf(e.get(f))),_(e.get(O)[e.get(h)])):e.get(f)!==q&&(_(e.get(f)),e.set(h,null)):e.set(f,e.get(x)[e.get(O).indexOf(_())]),e.set(n,!1),e.set(k,null),e.set(I,p().map((o,d)=>d),!0),l.on_blur?.(),l.on_input?.()}async function V(o){await ie(),e.set(I,te(p(),e.get(f)),!0),e.set(k,e.get(I).length>0?e.get(I)[0]:null,!0),(d=>{var g=e.to_array(d,2);e.set(n,g[0]),e.set(k,g[1],!0)})(re(o,e.get(k),e.get(I))),o.key==="Enter"&&(q=e.get(f),e.get(k)!==null?(e.set(h,e.get(k)),_(e.get(O)[e.get(k)]),e.set(n,!1),R.blur(),e.set(k,null)):e.get(x).includes(e.get(f))?(e.set(h,e.get(x).indexOf(e.get(f))),_(e.get(O)[e.get(h)]),e.set(n,!1),e.set(k,null),R.blur()):C()&&(_(e.get(f)),e.set(h,null),e.set(n,!1),e.set(k,null),R.blur()))}let J=e.state(e.proxy(_()));e.user_effect(()=>{e.get(J)!==_()&&(e.set(J,_(),!0),l.on_change?.(_()))});var a=xe();let c;var P=e.child(a);{var z=o=>{ae(o,{get buttons(){return m()},get on_custom_button_click(){return E()}})};e.if(P,o=>{T()&&m()&&m().length>0&&o(z)})}var A=e.sibling(P,2);Z(A,{get show_label(){return T()},get info(){return u()},children:(o,d)=>{e.next();var g=e.text();e.template_effect(()=>e.set_text(g,s())),e.append(o,g)},$$slots:{default:!0}});var S=e.sibling(A,2),r=e.child(S);let i;var b=e.child(r),v=e.child(b);e.remove_input_defaults(v);let L;e.bind_this(v,o=>R=o,()=>R);var K=e.sibling(v,2);{var N=o=>{var d=ye(),g=e.child(d);$(g),e.reset(d),e.append(o,d)};e.if(K,o=>{e.get(j)||o(N)})}e.reset(b),e.reset(r);var M=e.sibling(r,2);{let o=e.derived(()=>e.get(h)===null?[]:[e.get(h)]);ee(M,{get show_options(){return e.get(n)},get choices(){return p()},get filtered_indices(){return e.get(I)},get disabled(){return e.get(j)},get selected_indices(){return e.get(o)},get active_index(){return e.get(k)},$$events:{change:Q,load:()=>e.set(W,!0)}})}e.reset(S),e.reset(a),e.template_effect(o=>{c=e.set_class(a,1,"svelte-1xfsv4t",null,c,{container:B()}),i=e.set_class(r,1,"wrap-inner svelte-1xfsv4t",null,i,{show_options:e.get(n)}),e.set_attribute(v,"aria-expanded",e.get(n)),e.set_attribute(v,"aria-label",s()),L=e.set_class(v,1,"border-none svelte-1xfsv4t",null,L,o),v.disabled=e.get(j),v.readOnly=!w()},[()=>({subdued:!e.get(x).includes(e.get(f))&&!C()})]),e.bind_value(v,()=>e.get(f),o=>e.set(f,o)),e.event("keydown",v,V),e.event("keyup",v,o=>{l.on_key_up?.({key:o.key,input_value:e.get(f)})}),e.event("blur",v,H),e.event("focus",v,F),e.append(y,a),e.pop()}var Ae=e.from_html("<!> <!>",1);function Qe(y,l){e.push(l,!0);let t=e.rest_props(l,["$$slots","$$events","$$legacy"]);const s=new se(t);ne(y,{get visible(){return s.shared.visible},get elem_id(){return s.shared.elem_id},get elem_classes(){return s.shared.elem_classes},get padding(){return s.shared.container},allow_overflow:!1,get scale(){return s.shared.scale},get min_width(){return s.shared.min_width},children:(u,_)=>{var p=Ae(),D=e.first_child(p);de(D,e.spread_props({get autoscroll(){return s.shared.autoscroll},get i18n(){return s.i18n}},()=>s.shared.loading_status,{on_clear_status:()=>s.dispatch("clear_status",loading_status)}));var T=e.sibling(D,2);{var B=w=>{we(w,{get gradio(){return s}})},C=w=>{ke(w,{get label(){return s.shared.label},get info(){return s.props.info},get choices(){return s.props.choices},get interactive(){return s.shared.interactive},get show_label(){return s.shared.show_label},get container(){return s.shared.container},get allow_custom_value(){return s.props.allow_custom_value},get filterable(){return s.props.filterable},get buttons(){return s.props.buttons},on_custom_button_click:m=>{s.dispatch("custom_button_click",{id:m})},on_change:()=>s.dispatch("change"),on_input:()=>s.dispatch("input"),on_select:m=>s.dispatch("select",m),on_focus:()=>s.dispatch("focus"),on_blur:()=>s.dispatch("blur"),on_key_up:m=>s.dispatch("key_up",m),get value(){return s.props.value},set value(m){s.props.value=m}})};e.if(T,w=>{s.props.multiselect?w(B):w(C,!1)})}e.append(u,p)},$$slots:{default:!0}}),e.pop()}export{ke as BaseDropdown,ee as BaseDropdownOptions,Ye as BaseExample,we as BaseMultiselect,Qe as default};
