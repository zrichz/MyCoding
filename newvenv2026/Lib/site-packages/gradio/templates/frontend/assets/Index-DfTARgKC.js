import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import"./i18n-CyvX8KmK.js";import{f as Ie,G as _t}from"./utils.svelte-Ceck75cM.js";import"./svelte/svelte_internal_flags_legacy.js";import{tick as ae,createEventDispatcher as Fe,onMount as he,onDestroy as pt,beforeUpdate as gt,afterUpdate as ft}from"./svelte/svelte_svelte.js";import{i as He,e as mt,l as Te,t as vt,g as ht,u as bt,A as xt,v as wt,V as yt,F as kt,B as qt}from"./IconButtonWrapper-D4LMIc_2.js";import{U as Ct}from"./ModifyUpload-2md6CVWe.js";import{I as zt}from"./Image-Bdf4wQSw.js";import"./ImagePreview-CBoeGuoF.js";import{o as Pe}from"./Index-CH40aAIn.js";import{u as At,p as Rt,M as Dt}from"./StaticAudio-BUAVPUMF.js";import"./Example-C7IUWWhU.js";import{p as Mt}from"./index-Dw8Uzof1.js";import{S as St}from"./StreamingBar-C6ky6DsM.js";import{default as Tr}from"./Example-D2Ybbd88.js";import"./svelte/svelte_store.js";import"./MarkdownCode-C7jLnxqj.js";import"./prism-python-B1e-54E9.js";import"./ShareButton-DGzDjeX1.js";import"./FullscreenButton-CdZP1GYm.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_motion.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_transition.js";import"./svelte/svelte_events.js";import"./Video-06U9X4-1.js";async function de(k,l,n){if(await ae(),l===n)return;const x=window.getComputedStyle(k),w=parseFloat(x.paddingTop),r=parseFloat(x.paddingBottom),W=parseFloat(x.lineHeight);let m=n===void 0?!1:w+r+W*n,D=w+r+l*W;k.style.height="1px";let R;m&&k.scrollHeight>m?R=m:k.scrollHeight<D?R=D:R=k.scrollHeight,k.style.height=`${R}px`}function Et(k,l){if(l.lines===l.max_lines)return;k.style.overflowY="scroll";function n(x){de(x.target,l.lines,l.max_lines)}if(k.addEventListener("input",n),!!l.text.trim())return de(k,l.lines,l.max_lines),{destroy:()=>k.removeEventListener("input",n)}}e.from_html("<audio></audio>");var It=e.from_html("<option> </option>"),Tt=e.from_html('<select class="device-select-large svelte-doy9oc" aria-label="Select input device"></select>'),Pt=e.from_html('<div class="device-selection-wrapper svelte-doy9oc"><!> <button class="record-button svelte-doy9oc" aria-label="Start recording"></button></div>'),Ft=e.from_html('<div class="waveform-wrapper svelte-doy9oc"></div> <div class="timestamp svelte-doy9oc"> </div> <button class="stop-button svelte-doy9oc" aria-label="Stop recording"><!></button>',1),Ht=e.from_html('<div class="minimal-audio-recorder svelte-doy9oc" data-testid="minimal-audio-recorder"><!></div>');function Bt(k,l){e.push(l,!1);let n=e.prop(l,"label",12),x=e.prop(l,"waveform_settings",28,()=>({})),w=e.prop(l,"recording",12,!1),r=e.prop(l,"upload",12),W=e.prop(l,"root",12),m=e.prop(l,"max_file_size",12,null),D=e.prop(l,"upload_promise",12,null);const R=Fe();let q=e.mutable_source(),M,h=e.mutable_source(),V=e.mutable_source(0),S,E=e.mutable_source(!1),I=e.mutable_source(!1),y=e.mutable_source([]),v=e.mutable_source(""),G=e.mutable_source(!1);const Z=()=>{clearInterval(S),S=setInterval(()=>{e.update(V)},1e3)},J=async()=>{if(!e.get(q))return;M&&M.destroy();const o=getComputedStyle(document.documentElement).getPropertyValue("--color-accent")||"#ff7c00";M=At.create({container:e.get(q),height:32,waveColor:"rgba(128, 128, 128, 0.5)",progressColor:o,cursorColor:"transparent",barWidth:2,barGap:2,barRadius:2,interact:!1,hideScrollbar:!0,...x()}),e.set(h,M.registerPlugin(Pe.create({scrollingWaveform:!0,scrollingWaveformWindow:7,renderRecordedAudio:!1}))),e.get(h).on("record-start",()=>{Z(),e.set(E,!0),e.set(I,!0)}),e.get(h).on("record-end",async i=>{clearInterval(S),e.set(E,!1),D((async()=>{try{const T=await i.arrayBuffer(),p=await new AudioContext({sampleRate:x().sampleRate||44100}).decodeAudioData(T);if(p){const z=await Rt(p),C=new File([z],"audio.wav",{type:"audio/wav"}),d=await Mt([C],!1),K=(await r()(d,W(),void 0,m()||void 0))?.[0];K&&R("change",K)}}catch(T){console.error("Error processing audio:",T)}finally{R("stop_recording"),D(null)}})()),await D()})};he(async()=>{try{const o=await Pe.getAvailableAudioDevices();e.set(y,o.filter(i=>i.deviceId)),e.get(y).length>0&&e.set(v,e.get(y)[0].deviceId),e.get(y).length>1?e.set(G,!0):await J()}catch{await J()}}),pt(()=>{clearInterval(S),e.get(h)&&e.get(h).stopMic(),M&&M.destroy()});async function Y(){if(e.set(G,!1),e.set(I,!0),await ae(),await J(),!!e.get(h))try{await e.get(h).startMic({deviceId:e.get(v)}),e.get(h).startRecording()}catch(o){console.error("Error starting recording:",o),e.set(G,e.get(y).length>1),e.set(I,!1),w(!1)}}e.legacy_pre_effect(()=>(e.deep_read_state(w()),e.get(E),e.get(h),e.get(I),e.get(y),e.get(v)),()=>{w()&&!e.get(E)&&e.get(h)&&e.get(I)===!1&&e.get(y).length<=1?e.get(h).startMic({deviceId:e.get(v)}).then(()=>{e.get(h)?.startRecording()}):!w()&&e.get(E)&&e.get(h)&&(e.get(h).stopRecording(),e.set(V,0))}),e.legacy_pre_effect_reset();var N={get label(){return n()},set label(o){n(o),e.flush()},get waveform_settings(){return x()},set waveform_settings(o){x(o),e.flush()},get recording(){return w()},set recording(o){w(o),e.flush()},get upload(){return r()},set upload(o){r(o),e.flush()},get root(){return W()},set root(o){W(o),e.flush()},get max_file_size(){return m()},set max_file_size(o){m(o),e.flush()},get upload_promise(){return D()},set upload_promise(o){D(o),e.flush()}};e.init();var j=Ht(),te=e.child(j);{var H=o=>{var i=Pt(),T=e.child(i);{var b=z=>{var C=Tt();e.template_effect(()=>{e.get(v),e.invalidate_inner_signals(()=>{e.get(y)})}),e.each(C,5,()=>e.get(y),e.index,(d,L)=>{var K=It(),ne=e.child(K,!0);e.reset(K);var B={};e.template_effect(()=>{e.set_text(ne,(e.get(L),e.untrack(()=>e.get(L).label))),B!==(B=(e.get(L),e.untrack(()=>e.get(L).deviceId)))&&(K.value=(K.__value=(e.get(L),e.untrack(()=>e.get(L).deviceId)))??"")}),e.append(d,K)}),e.reset(C),e.bind_select_value(C,()=>e.get(v),d=>e.set(v,d)),e.append(z,C)};e.if(T,z=>{e.get(y),e.untrack(()=>e.get(y).length>1)&&z(b)})}var p=e.sibling(T,2);e.reset(i),e.event("click",p,Y),e.append(o,i)},re=o=>{var i=Ft(),T=e.first_child(i);e.bind_this(T,d=>e.set(q,d),()=>e.get(q));var b=e.sibling(T,2),p=e.child(b,!0);e.reset(b);var z=e.sibling(b,2),C=e.child(z);He(C,{}),e.reset(z),e.template_effect(d=>e.set_text(p,d),[()=>(e.deep_read_state(Ie),e.get(V),e.untrack(()=>Ie(e.get(V))))]),e.event("click",z,()=>{w(!1)}),e.append(o,i)};e.if(te,o=>{e.get(G)?o(H):o(re,!1)})}return e.reset(j),e.template_effect(()=>e.set_attribute(j,"aria-label",n()||"Audio Recorder")),e.append(k,j),e.pop(N)}var Ut=e.from_html('<div class="recording-content svelte-1qn0337"><!></div>'),Wt=e.from_html('<div class="recording-content svelte-1qn0337"><!> <div class="action-buttons svelte-1qn0337"><button class="confirm-button svelte-1qn0337" aria-label="Attach audio"><!></button> <button class="cancel-button svelte-1qn0337" aria-label="Clear audio"><!></button></div></div>'),Gt=e.from_html("<div><!></div>"),Vt=e.from_html('<button data-testid="upload-button" class="upload-button thumbnail-add svelte-1qn0337" aria-label="Upload a file"><!></button>'),jt=e.from_html('<span class="thumbnail-wrapper svelte-1qn0337" role="listitem" aria-label="File thumbnail"><div class="thumbnail-item thumbnail-small svelte-1qn0337"><!> <button class="delete-button svelte-1qn0337" aria-label="Remove file"><!></button></div></span>'),Lt=e.from_html('<div class="loader svelte-1qn0337" role="status" aria-label="Uploading"></div>'),Kt=e.from_html('<div class="thumbnails svelte-1qn0337" aria-label="Uploaded files" data-testid="container_el"><!> <!> <!></div>'),Yt=e.from_html('<button data-testid="microphone-button" aria-label="Record audio"><!></button>'),Xt=e.from_html('<button data-testid="submit-button" aria-label="Submit"><!></button>'),Jt=e.from_html('<button aria-label="Stop"><!></button>'),Nt=e.from_html('<div role="group" aria-label="Multimedia input field"><!> <div class="input-container svelte-1qn0337"><!> <!> <div><!> <div class="input-row svelte-1qn0337"><textarea data-testid="textbox"></textarea> <!> <!> <!></div></div></div></div>');function Ot(k,l){e.push(l,!1);const n=e.mutable_source(),x=e.mutable_source(),w=e.mutable_source();let r=e.prop(l,"value",28,()=>({text:"",files:[]})),W=e.prop(l,"value_is_output",12,!1),m=e.prop(l,"lines",12,1),D=e.prop(l,"i18n",12),R=e.prop(l,"placeholder",12,""),q=e.prop(l,"disabled",12,!1),M=e.prop(l,"label",12),h=e.prop(l,"info",12,void 0),V=e.prop(l,"show_label",12,!0),S=e.prop(l,"max_lines",12),E=e.prop(l,"submit_btn",12,null),I=e.prop(l,"stop_btn",12,null),y=e.prop(l,"rtl",12,!1),v=e.prop(l,"autofocus",12,!1),G=e.prop(l,"text_align",12,void 0),Z=e.prop(l,"autoscroll",12,!0),J=e.prop(l,"root",12),Y=e.prop(l,"file_types_string",12,null),N=e.prop(l,"max_file_size",12,null),j=e.prop(l,"upload",12),te=e.prop(l,"stream_handler",12),H=e.prop(l,"file_count",12,"multiple"),re=e.prop(l,"max_plain_text_length",12,1e3),o=e.prop(l,"waveform_settings",12),i=e.prop(l,"waveform_options",28,()=>({show_recording_waveform:!0})),T=e.prop(l,"sources_string",12,"upload"),b=e.prop(l,"active_source",12,null),p=e.prop(l,"html_attributes",12,null),z=e.prop(l,"upload_promise",12,null),C=e.mutable_source(),d=e.mutable_source(),L,K=0,ne=!1,B=e.prop(l,"dragging",12,!1),le=e.mutable_source(!1),ce=e.mutable_source(r()?.text??""),O=e.mutable_source(!1),X=e.mutable_source(null),_e=e.mutable_source();const P=Fe();gt(()=>{L=e.get(d)&&e.get(d).offsetHeight+e.get(d).scrollTop>e.get(d).scrollHeight-100});const Be=()=>{L&&Z()&&!ne&&e.get(d).scrollTo(0,e.get(d).scrollHeight)};async function be(){P("change",r()),W()||P("input")}he(()=>{v()&&e.get(d)!==null&&e.get(d).focus()}),ft(()=>{L&&Z()&&Be(),v()&&e.get(d)&&e.get(d).focus()});function Ue(t){const a=t.target,s=a.value,c=[a.selectionStart,a.selectionEnd];P("select",{value:s.substring(...c),index:c})}async function We(t){t.key==="Enter"&&t.shiftKey&&m()>1?(t.preventDefault(),await ae(),P("submit")):t.key==="Enter"&&!t.shiftKey&&m()===1&&S()>=1&&(t.preventDefault(),pe(),b(null),await ae(),P("submit"))}function Ge(t){const a=t.target,s=a.scrollTop;s<K&&(ne=!0),K=s;const c=a.scrollHeight-a.clientHeight;s>=c&&(ne=!1)}async function Ve({detail:t}){if(be(),Array.isArray(t)){for(let a of t)r().files.push(a);r(r())}else r().files.push(t),r(r());await ae(),P("change",r()),P("upload",t)}function je(t,a){be(),t.stopPropagation(),r().files.splice(a,1),r(r())}function Le(){e.get(C).open_upload()}function Ke(){P("stop")}function pe(){e.get(X)&&(r().files.push(e.get(X)),r(r()),e.set(X,null),P("change",r()))}function Ye(){pe(),b(null),P("submit")}async function Xe(t){if(!t.clipboardData)return;const a=t.clipboardData.items,s=t.clipboardData.getData("text");if(s&&s.length>re()){t.preventDefault();const c=new window.File([s],"pasted_text.txt",{type:"text/plain",lastModified:Date.now()});e.get(C)&&e.get(C).load_files([c]);return}for(let c in a){const A=a[c];if(A.kind==="file"&&A.type.includes("image")){const F=A.getAsFile();F&&e.get(C).load_files([F])}}}function Je(t){t.preventDefault(),B(!0)}function Ne(t){t.preventDefault();const a=e.get(_e).getBoundingClientRect(),{clientX:s,clientY:c}=t;(s<=a.left||s>=a.right||c<=a.top||c>=a.bottom)&&B(!1)}function Oe(t){if(t.preventDefault(),B(!1),t.dataTransfer&&t.dataTransfer.files){const a=Array.from(t.dataTransfer.files);if(e.get(x)){const s=a.filter(A=>e.get(x).some(F=>F.startsWith(".")?A.name.toLowerCase().endsWith(F.toLowerCase()):A.type.match(new RegExp(F.replace("*",".*"))))),c=a.length-s.length;c>0&&P("error",`${c} file(s) were rejected. Accepted formats: ${e.get(x).join(", ")}`),s.length>0&&e.get(C).load_files(s)}else e.get(C).load_files(a)}}e.legacy_pre_effect(()=>e.deep_read_state(T()),()=>{e.set(n,T().split(",").map(t=>t.trim()).filter(t=>t==="upload"||t==="microphone"))}),e.legacy_pre_effect(()=>e.deep_read_state(Y()),()=>{e.set(x,Y()?Y().split(",").map(t=>t.trim()):null)}),e.legacy_pre_effect(()=>e.deep_read_state(B()),()=>{P("drag",B())}),e.legacy_pre_effect(()=>e.deep_read_state(r()),()=>{r()===null&&r({text:"",files:[]})}),e.legacy_pre_effect(()=>(e.get(n),e.deep_read_state(H()),e.deep_read_state(r())),()=>{e.set(w,e.get(n)&&e.get(n).includes("upload")&&!(H()==="single"&&r().files.length>0))}),e.legacy_pre_effect(()=>(e.get(ce),e.deep_read_state(r())),()=>{e.get(ce)!==r().text&&(P("change",r()),e.set(ce,r().text))}),e.legacy_pre_effect(()=>(e.deep_read_state(r()),e.get(d),e.deep_read_state(m()),e.deep_read_state(S()),de),()=>{r(),e.get(d)&&m()!==S()&&de(e.get(d),m(),S())}),e.legacy_pre_effect_reset();var Qe={get value(){return r()},set value(t){r(t),e.flush()},get value_is_output(){return W()},set value_is_output(t){W(t),e.flush()},get lines(){return m()},set lines(t){m(t),e.flush()},get i18n(){return D()},set i18n(t){D(t),e.flush()},get placeholder(){return R()},set placeholder(t){R(t),e.flush()},get disabled(){return q()},set disabled(t){q(t),e.flush()},get label(){return M()},set label(t){M(t),e.flush()},get info(){return h()},set info(t){h(t),e.flush()},get show_label(){return V()},set show_label(t){V(t),e.flush()},get max_lines(){return S()},set max_lines(t){S(t),e.flush()},get submit_btn(){return E()},set submit_btn(t){E(t),e.flush()},get stop_btn(){return I()},set stop_btn(t){I(t),e.flush()},get rtl(){return y()},set rtl(t){y(t),e.flush()},get autofocus(){return v()},set autofocus(t){v(t),e.flush()},get text_align(){return G()},set text_align(t){G(t),e.flush()},get autoscroll(){return Z()},set autoscroll(t){Z(t),e.flush()},get root(){return J()},set root(t){J(t),e.flush()},get file_types_string(){return Y()},set file_types_string(t){Y(t),e.flush()},get max_file_size(){return N()},set max_file_size(t){N(t),e.flush()},get upload(){return j()},set upload(t){j(t),e.flush()},get stream_handler(){return te()},set stream_handler(t){te(t),e.flush()},get file_count(){return H()},set file_count(t){H(t),e.flush()},get max_plain_text_length(){return re()},set max_plain_text_length(t){re(t),e.flush()},get waveform_settings(){return o()},set waveform_settings(t){o(t),e.flush()},get waveform_options(){return i()},set waveform_options(t){i(t),e.flush()},get sources_string(){return T()},set sources_string(t){T(t),e.flush()},get active_source(){return b()},set active_source(t){b(t),e.flush()},get html_attributes(){return p()},set html_attributes(t){p(t),e.flush()},get upload_promise(){return z()},set upload_promise(t){z(t),e.flush()},get dragging(){return B()},set dragging(t){B(t),e.flush()}};e.init();var Q=Nt();let xe;var we=e.child(Q);mt(we,{get show_label(){return V()},get info(){return h()},get rtl(){return y()},children:(t,a)=>{e.next();var s=e.text();e.template_effect(()=>e.set_text(s,M())),e.append(t,s)},$$slots:{default:!0}});var ye=e.sibling(we,2),ke=e.child(ye);{var Ze=t=>{var a=Gt();let s;var c=e.child(a);{var A=f=>{var g=Ut(),_=e.child(g);{let $=e.derived_safe_equal(()=>M()||"Audio");Bt(_,{get label(){return e.get($)},get waveform_settings(){return o()},get recording(){return e.get(O)},get upload(){return j()},get root(){return J()},get max_file_size(){return N()},get upload_promise(){return z()},set upload_promise(U){z(U)},$$events:{change:({detail:U})=>{e.set(X,U)},stop_recording:()=>{e.set(O,!1),P("stop_recording")},clear:()=>{b(null),e.set(O,!1),e.set(X,null)},error:({detail:U})=>{b(null),e.set(O,!1),e.set(X,null)}},$$legacy:!0})}e.reset(g),e.append(f,g)},F=f=>{var g=Wt(),_=e.child(g);{let me=e.derived_safe_equal(()=>M()||"Audio");Dt(_,{get value(){return e.get(X)},get label(){return e.get(me)},loop:!1})}var $=e.sibling(_,2),U=e.child($),ue=e.child(U);ht(ue),e.reset(U);var se=e.sibling(U,2),fe=e.child(se);Te(fe),e.reset(se),e.reset($),e.reset(g),e.event("click",U,()=>{pe(),b(null),e.set(O,!1)}),e.event("click",se,()=>{b(null),e.set(O,!1),e.set(X,null)}),e.append(f,g)};e.if(c,f=>{e.get(X)?f(F,!1):f(A)})}e.reset(a),e.template_effect(()=>s=e.set_class(a,1,"recording-overlay svelte-1qn0337",null,s,{"has-audio":e.get(X)!==null})),e.append(t,a)};e.if(ke,t=>{e.get(n),e.deep_read_state(b()),e.untrack(()=>e.get(n)&&e.get(n).includes("microphone")&&b()==="microphone")&&t(Ze)})}var qe=e.sibling(ke,2);{var $e=t=>{e.bind_this(Ct(t,{get file_count(){return H()},get filetype(){return e.get(x)},get root(){return J()},get max_file_size(){return N()},show_progress:!1,disable_click:!0,hidden:!0,get upload(){return j()},get stream_handler(){return te()},get upload_promise(){return z()},set upload_promise(a){z(a)},get dragging(){return B()},set dragging(a){B(a)},get uploading(){return e.get(le)},set uploading(a){e.set(le,a)},$$events:{load:Ve,error(a){e.bubble_event.call(this,l,a)}},$$legacy:!0}),a=>e.set(C,a),()=>e.get(C))};e.if(qe,t=>{e.get(w)&&t($e)})}var ge=e.sibling(qe,2);let Ce;var ze=e.child(ge);{var et=t=>{var a=Kt(),s=e.child(a);{var c=g=>{var _=Vt(),$=e.child(_);bt($),e.reset(_),e.template_effect(()=>_.disabled=q()),e.event("click",_,Le),e.append(g,_)};e.if(s,g=>{e.get(w)&&g(c)})}var A=e.sibling(s,2);e.each(A,1,()=>(e.deep_read_state(r()),e.untrack(()=>r().files)),e.index,(g,_,$)=>{var U=jt(),ue=e.child(U),se=e.child(ue);{var fe=ee=>{zt(ee,{get src(){return e.get(_),e.untrack(()=>e.get(_).url)},restProps:{title:null,alt:"",loading:"lazy",class:"thumbnail-image"}})},me=ee=>{var Se=e.comment(),ot=e.first_child(Se);{var it=oe=>{wt(oe)},nt=oe=>{var Ee=e.comment(),ut=e.first_child(Ee);{var dt=ie=>{yt(ie)},ct=ie=>{kt(ie)};e.if(ut,ie=>{e.get(_),e.untrack(()=>e.get(_).mime_type&&e.get(_).mime_type.includes("video"))?ie(dt):ie(ct,!1)},!0)}e.append(oe,Ee)};e.if(ot,oe=>{e.get(_),e.untrack(()=>e.get(_).mime_type&&e.get(_).mime_type.includes("audio"))?oe(it):oe(nt,!1)},!0)}e.append(ee,Se)};e.if(se,ee=>{e.get(_),e.untrack(()=>e.get(_).mime_type&&e.get(_).mime_type.includes("image"))?ee(fe):ee(me,!1)})}var ve=e.sibling(se,2),st=e.child(ve);Te(st),e.reset(ve),e.reset(ue),e.reset(U),e.event("click",ve,ee=>je(ee,$)),e.append(g,U)});var F=e.sibling(A,2);{var f=g=>{var _=Lt();e.append(g,_)};e.if(F,g=>{e.get(le)&&g(f)})}e.reset(a),e.append(t,a)};e.if(ze,t=>{e.deep_read_state(r()),e.get(le),e.get(w),e.untrack(()=>r().files.length>0||e.get(le)||e.get(w))&&t(et)})}var Ae=e.sibling(ze,2),u=e.child(Ae);e.remove_textarea_child(u);let Re;e.action(u,(t,a)=>Et?.(t,a),()=>({text:r().text,lines:m(),max_lines:S()})),e.effect(()=>e.bind_value(u,()=>r().text,t=>r(r().text=t,!0))),e.bind_this(u,t=>e.set(d,t),()=>e.get(d)),e.effect(()=>e.event("keypress",u,We)),e.effect(()=>e.event("blur",u,function(t){e.bubble_event.call(this,l,t)})),e.effect(()=>e.event("select",u,Ue)),e.effect(()=>e.event("focus",u,function(t){e.bubble_event.call(this,l,t)})),e.effect(()=>e.event("scroll",u,Ge)),e.effect(()=>e.event("paste",u,Xe));var De=e.sibling(u,2);{var tt=t=>{var a=Yt();let s;var c=e.child(a);vt(c),e.reset(a),e.template_effect(()=>{s=e.set_class(a,1,"microphone-button svelte-1qn0337",null,s,{recording:e.get(O)}),a.disabled=q()}),e.event("click",a,async()=>{b()!=="microphone"?(b("microphone"),await ae(),e.set(O,!0)):(b(null),e.set(O,!1))}),e.append(t,a)};e.if(De,t=>{e.get(n),e.untrack(()=>e.get(n)&&e.get(n).includes("microphone"))&&t(tt)})}var Me=e.sibling(De,2);{var rt=t=>{var a=Xt();let s;var c=e.child(a);{var A=f=>{xt(f)},F=f=>{var g=e.text();e.template_effect(()=>e.set_text(g,E())),e.append(f,g)};e.if(c,f=>{E()===!0?f(A):f(F,!1)})}e.reset(a),e.template_effect(()=>{s=e.set_class(a,1,"submit-button svelte-1qn0337",null,s,{"padded-button":E()!==!0}),a.disabled=q()}),e.event("click",a,Ye),e.append(t,a)};e.if(Me,t=>{E()&&t(rt)})}var at=e.sibling(Me,2);{var lt=t=>{var a=Jt();let s;var c=e.child(a);{var A=f=>{He(f,{fill:"none",stroke_width:2.5})},F=f=>{var g=e.text();e.template_effect(()=>e.set_text(g,I())),e.append(f,g)};e.if(c,f=>{I()===!0?f(A):f(F,!1)})}e.reset(a),e.template_effect(()=>s=e.set_class(a,1,"stop-button svelte-1qn0337",null,s,{"padded-button":I()!==!0})),e.event("click",a,Ke),e.append(t,a)};e.if(at,t=>{I()&&t(lt)})}return e.reset(Ae),e.reset(ge),e.reset(ye),e.reset(Q),e.bind_this(Q,t=>e.set(_e,t),()=>e.get(_e)),e.template_effect(()=>{xe=e.set_class(Q,1,"full-container svelte-1qn0337",null,xe,{dragging:B()}),Ce=e.set_class(ge,1,"input-wrapper svelte-1qn0337",null,Ce,{"has-files":r().files.length>0||e.get(le)}),e.set_attribute(u,"dir",y()?"rtl":"ltr"),e.set_attribute(u,"placeholder",R()),e.set_attribute(u,"rows",m()),u.disabled=q(),e.set_style(u,G()?"text-align: "+G():""),e.set_attribute(u,"autocapitalize",(e.deep_read_state(p()),e.untrack(()=>p()?.autocapitalize))),e.set_attribute(u,"autocorrect",(e.deep_read_state(p()),e.untrack(()=>p()?.autocorrect))),e.set_attribute(u,"spellcheck",(e.deep_read_state(p()),e.untrack(()=>p()?.spellcheck))),e.set_attribute(u,"autocomplete",(e.deep_read_state(p()),e.untrack(()=>p()?.autocomplete))),e.set_attribute(u,"tabindex",(e.deep_read_state(p()),e.untrack(()=>p()?.tabindex))),e.set_attribute(u,"enterkeyhint",(e.deep_read_state(p()),e.untrack(()=>p()?.enterkeyhint))),e.set_attribute(u,"lang",(e.deep_read_state(p()),e.untrack(()=>p()?.lang))),Re=e.set_class(u,1,"svelte-1qn0337",null,Re,{"no-label":!V()}),u.dir=u.dir}),e.event("dragenter",Q,Je),e.event("dragleave",Q,Ne),e.event("dragover",Q,e.preventDefault(function(t){e.bubble_event.call(this,l,t)})),e.event("drop",Q,Oe),e.append(k,Q),e.pop(Qe)}var Qt=e.from_html("<!> <!>",1);function Sr(k,l){e.push(l,!0);let n=e.state(void 0);class x extends _t{async get_data(){return e.get(n)&&(await e.get(n),await ae()),await super.get_data()}}let w=e.rest_props(l,["$$slots","$$events","$$legacy"]);const r=new x(w),W=e.derived(()=>r.props.value||{text:"",files:[]});let m=e.state(!1),D=e.state(null),R="darkorange";const q={height:50,barWidth:2,barGap:3,cursorWidth:2,cursorColor:"#ddd5e9",autoplay:!1,barRadius:10,dragToSeek:!0,normalize:!0,minPxPerSec:20,waveColor:"",progressColor:"",mediaControls:!1,sampleRate:44100};he(()=>{R=getComputedStyle(document?.documentElement).getPropertyValue("--color-accent"),h(),q.waveColor=r.props?.waveform_options?.waveform_color||"#9ca3af",q.progressColor=r.props?.waveform_options?.waveform_progress_color||R,q.mediaControls=r.props?.waveform_options?.show_controls,q.sampleRate=r.props?.waveform_options?.sample_rate||44100});const M={color:r.props?.waveform_options?.trim_region_color};function h(){document.documentElement.style.setProperty("--trim-region-color",M.color||R)}const V=(...v)=>r.shared.client.upload(...v),S=v=>r.i18n(v),E=(...v)=>r.shared.client.stream(...v);let I=e.derived(()=>r.props.sources.join(",")),y=e.derived(()=>(r.props.file_types||[]).join(",")||null);{let v=e.derived(()=>[...r.shared.elem_classes||[],"multimodal-textbox"]),G=e.derived(()=>e.get(m)?"focus":"base");qt(k,{get visible(){return r.shared.visible},get elem_id(){return r.shared.elem_id},get elem_classes(){return e.get(v)},get scale(){return r.shared.scale},get min_width(){return r.shared.min_width},allow_overflow:!1,padding:!1,get border_mode(){return e.get(G)},children:(Z,J)=>{var Y=Qt(),N=e.first_child(Y);{var j=H=>{St(H,e.spread_props({get autoscroll(){return r.shared.autoscroll},get i18n(){return r.i18n}},()=>r.shared.loading_status,{on_clear_status:()=>r.dispatch("clear_status",r.shared.loading_status)}))};e.if(N,H=>{r.shared.loading_status&&H(j)})}var te=e.sibling(N,2);{let H=e.derived(()=>r.shared.label||"MultimodalTextbox"),re=e.derived(()=>r.props.max_lines?r.props.max_lines:r.props.lines+1),o=e.derived(()=>!r.shared.interactive);Ot(te,{get value(){return e.get(W)},value_is_output:!0,get file_types_string(){return e.get(y)},get root(){return r.shared.root},get label(){return e.get(H)},get info(){return r.props.info},get show_label(){return r.shared.show_label},get lines(){return r.props.lines},get rtl(){return r.props.rtl},get text_align(){return r.props.text_align},get waveform_settings(){return q},i18n:S,get max_lines(){return e.get(re)},get placeholder(){return r.props.placeholder},get submit_btn(){return r.props.submit_btn},get stop_btn(){return r.props.stop_btn},get autofocus(){return r.props.autofocus},get autoscroll(){return r.shared.autoscroll},get file_count(){return r.props.file_count},get sources_string(){return e.get(I)},get max_file_size(){return r.shared.max_file_size},get disabled(){return e.get(o)},upload:V,stream_handler:E,get max_plain_text_length(){return r.props.max_plain_text_length},get html_attributes(){return r.props.html_attributes},get upload_promise(){return e.get(n)},set upload_promise(i){e.set(n,i,!0)},get dragging(){return e.get(m)},set dragging(i){e.set(m,i,!0)},get active_source(){return e.get(D)},set active_source(i){e.set(D,i,!0)},$$events:{change:i=>(r.props.value=i.detail,r.dispatch("change",r.props.value)),input:()=>r.dispatch("input"),submit:()=>r.dispatch("submit"),stop:()=>r.dispatch("stop"),blur:()=>r.dispatch("blur"),select:i=>r.dispatch("select",i.detail),focus:()=>r.dispatch("focus"),error:({detail:i})=>{r.dispatch("error",i)},start_recording:()=>r.dispatch("start_recording"),pause_recording:()=>r.dispatch("pause_recording"),stop_recording:()=>r.dispatch("stop_recording"),upload:i=>r.dispatch("upload",i.detail),clear:()=>r.dispatch("clear")}})}e.append(Z,Y)},$$slots:{default:!0}})}e.pop()}export{Tr as BaseExample,Ot as BaseMultimodalTextbox,Sr as default};
