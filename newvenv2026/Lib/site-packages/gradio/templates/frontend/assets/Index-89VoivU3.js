import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import"./i18n-CyvX8KmK.js";import{G as H}from"./utils.svelte-Ceck75cM.js";import"./svelte/svelte_internal_flags_legacy.js";import{createEventDispatcher as J,tick as K}from"./svelte/svelte_svelte.js";import{B as L}from"./Button-CJbn8n9a.js";import{p as M}from"./index-Dw8Uzof1.js";import"./svelte/svelte_store.js";import"./Image-Bdf4wQSw.js";import"./ImagePreview-CBoeGuoF.js";import"./IconButtonWrapper-D4LMIc_2.js";import"./MarkdownCode-C7jLnxqj.js";import"./prism-python-B1e-54E9.js";import"./ShareButton-DGzDjeX1.js";import"./FullscreenButton-CdZP1GYm.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_motion.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_transition.js";import"./svelte/svelte_events.js";var N=e.from_html('<img class="button-icon svelte-94gmgt"/>'),O=e.from_html("<!> <!>",1),Q=e.from_html('<input class="hide svelte-94gmgt" type="file"/> <!>',1);function R(h,l){e.push(l,!1);let _=e.prop(l,"elem_id",12,""),r=e.prop(l,"elem_classes",28,()=>[]),u=e.prop(l,"visible",12,!0),d=e.prop(l,"label",12),o=e.prop(l,"value",12),i=e.prop(l,"file_count",12),a=e.prop(l,"file_types",28,()=>[]),c=e.prop(l,"root",12),v=e.prop(l,"size",12,"lg"),m=e.prop(l,"icon",12,null),b=e.prop(l,"scale",12,null),y=e.prop(l,"min_width",12,void 0),z=e.prop(l,"variant",12,"secondary"),w=e.prop(l,"disabled",12,!1),x=e.prop(l,"max_file_size",12,null),k=e.prop(l,"upload",12);const g=J();let B=e.mutable_source(),G=e.mutable_source();a()==null?e.set(G,null):(a(a().map(t=>t.startsWith(".")?t:t+"/*")),e.set(G,a().join(", ")));function j(){g("click"),e.get(B).click()}async function A(t){let n=Array.from(t);if(!t.length)return;i()==="single"&&(n=[t[0]]);let p=await M(n);await K();try{p=(await k()(p,c(),void 0,x()??1/0))?.filter(f=>f!==null)}catch(f){g("error",f.message);return}o(i()==="single"?p?.[0]:p),g("change",o()),g("upload",o())}async function D(t){const n=t.target;n.files&&await A(n.files)}function E(t){const n=t.target;n.value&&(n.value="")}var W={get elem_id(){return _()},set elem_id(t){_(t),e.flush()},get elem_classes(){return r()},set elem_classes(t){r(t),e.flush()},get visible(){return u()},set visible(t){u(t),e.flush()},get label(){return d()},set label(t){d(t),e.flush()},get value(){return o()},set value(t){o(t),e.flush()},get file_count(){return i()},set file_count(t){i(t),e.flush()},get file_types(){return a()},set file_types(t){a(t),e.flush()},get root(){return c()},set root(t){c(t),e.flush()},get size(){return v()},set size(t){v(t),e.flush()},get icon(){return m()},set icon(t){m(t),e.flush()},get scale(){return b()},set scale(t){b(t),e.flush()},get min_width(){return y()},set min_width(t){y(t),e.flush()},get variant(){return z()},set variant(t){z(t),e.flush()},get disabled(){return w()},set disabled(t){w(t),e.flush()},get max_file_size(){return x()},set max_file_size(t){x(t),e.flush()},get upload(){return k()},set upload(t){k(t),e.flush()}};e.init();var U=Q(),s=e.first_child(U);e.bind_this(s,t=>e.set(B,t),()=>e.get(B));var q=e.sibling(s,2);return L(q,{get size(){return v()},get variant(){return z()},get elem_id(){return _()},get elem_classes(){return r()},get visible(){return u()},get scale(){return b()},get min_width(){return y()},get disabled(){return w()},$$events:{click:j},children:(t,n)=>{var p=O(),f=e.first_child(p);{var C=I=>{var P=N();e.template_effect(()=>{e.set_attribute(P,"src",(e.deep_read_state(m()),e.untrack(()=>m().url))),e.set_attribute(P,"alt",`${o()} icon`)}),e.append(I,P)};e.if(f,I=>{m()&&I(C)})}var F=e.sibling(f,2);e.slot(F,l,"default",{},null),e.append(t,p)},$$slots:{default:!0}}),e.template_effect(()=>{e.set_attribute(s,"accept",e.get(G)),s.multiple=i()==="multiple"||void 0,s.webkitdirectory=i()==="directory"||void 0,e.set_attribute(s,"mozdirectory",i()==="directory"||void 0),e.set_attribute(s,"data-testid",`${d()??""}-upload-button`)}),e.event("change",s,D),e.event("click",s,E),e.append(h,U),e.pop(W)}function ye(h,l){e.push(l,!0);const _=e.rest_props(l,["$$slots","$$events","$$legacy"]),r=new H(_);let u=e.proxy(r.props.value);e.user_effect(()=>{u!==r.props.value&&(r.props.value=u)});async function d(i,a){r.props.value=i,r.dispatch(a)}const o=e.derived(()=>!r.shared.interactive);R(h,{get elem_id(){return r.shared.elem_id},get elem_classes(){return r.shared.elem_classes},get visible(){return r.shared.visible},get file_count(){return r.props.file_count},get file_types(){return r.props.file_types},get size(){return r.props.size},get scale(){return r.shared.scale},get icon(){return r.props.icon},get min_width(){return r.shared.min_width},get root(){return r.shared.root},get value(){return u},get disabled(){return e.get(o)},get variant(){return r.props.variant},get label(){return r.shared.label},get max_file_size(){return r.shared.max_file_size},upload:(...i)=>r.shared.client.upload(...i),$$events:{click:()=>r.dispatch("click"),change:({detail:i})=>d(i,"change"),upload:({detail:i})=>d(i,"upload"),error:({detail:i})=>{r.dispatch("error",i)}},children:(i,a)=>{e.next();var c=e.text();e.template_effect(()=>e.set_text(c,r.shared.label??"")),e.append(i,c)},$$slots:{default:!0}}),e.pop()}export{R as BaseUploadButton,ye as default};
