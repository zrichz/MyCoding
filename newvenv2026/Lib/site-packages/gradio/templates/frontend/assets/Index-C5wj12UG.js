import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import"./i18n-CyvX8KmK.js";import{G as ne}from"./utils.svelte-Ceck75cM.js";import{j as se,b as ee,F as N,c as Q,E as oe,I as X,l as ue,m as ie,B as ge,U as de}from"./IconButtonWrapper-D4LMIc_2.js";import"./svelte/svelte_internal_flags_legacy.js";import{createEventDispatcher as te,tick as re}from"./svelte/svelte_svelte.js";import{U as Z}from"./ModifyUpload-2md6CVWe.js";import{S as _e}from"./StreamingBar-C6ky6DsM.js";import{default as Ze}from"./Example-C86RGnmZ.js";import"./svelte/svelte_store.js";import"./index-Dw8Uzof1.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_motion.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_transition.js";import"./svelte/svelte_events.js";import"./MarkdownCode-C7jLnxqj.js";import"./prism-python-B1e-54E9.js";const $=A=>{let l=["B","KB","MB","GB","PB"],a=0;for(;A>1024;)A/=1024,a++;let h=l[a];return A.toFixed(1)+"&nbsp;"+h};var ce=e.from_html('<span class="drag-handle svelte-al0bnp">⋮⋮</span>'),pe=e.from_html("<!>&nbsp;&#8675;",1),he=e.from_html('<td class="svelte-al0bnp"><button class="label-clear-button svelte-al0bnp" aria-label="Remove this file">×</button></td>'),fe=e.from_html('<tr><td class="filename svelte-al0bnp"><!> <span class="stem svelte-al0bnp"> </span> <span class="ext svelte-al0bnp"> </span></td><td class="download svelte-al0bnp"><!></td><!></tr>'),ve=e.from_html('<div class="file-preview-holder svelte-al0bnp"><table class="file-preview svelte-al0bnp"><tbody class="svelte-al0bnp"></tbody></table></div>');function le(A,l){e.push(l,!1);const a=e.mutable_source(),h=te();let g=e.prop(l,"value",12),w=e.prop(l,"selectable",12,!1),t=e.prop(l,"height",12,void 0),y=e.prop(l,"i18n",12),m=e.prop(l,"allow_reordering",12,!1),f=e.mutable_source(null),d=e.mutable_source(null);function _(n,s){e.set(f,s),n.dataTransfer&&(n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/plain",s.toString()))}function v(n,s){if(n.preventDefault(),s===e.get(a).length-1){const u=n.currentTarget.getBoundingClientRect(),p=u.top+u.height/2;e.set(d,n.clientY>p?e.get(a).length:s)}else e.set(d,s);n.dataTransfer&&(n.dataTransfer.dropEffect="move")}function z(n){(!n.dataTransfer?.dropEffect||n.dataTransfer.dropEffect==="none")&&(e.set(f,null),e.set(d,null))}function F(n,s){if(n.preventDefault(),e.get(f)===null||e.get(f)===s)return;const u=Array.isArray(g())?[...g()]:[g()],[p]=u.splice(e.get(f),1);u.splice(e.get(d)===e.get(a).length?e.get(a).length:s,0,p);const C=Array.isArray(g())?u:u[0];h("change",C),e.set(f,null),e.set(d,null)}function I(n){const s=n.lastIndexOf(".");return s===-1?[n,""]:[n.slice(0,s),n.slice(s)]}function P(n,s){const u=n.currentTarget;(n.target===u||u&&u.firstElementChild&&n.composedPath().includes(u.firstElementChild))&&h("select",{value:e.get(a)[s].orig_name,index:s})}function c(n){const s=e.get(a).splice(n,1);e.set(a,[...e.get(a)]),g(e.get(a)),h("delete",s[0]),h("change",e.get(a))}function o(n){h("download",n)}const L=typeof window<"u";e.legacy_pre_effect(()=>e.deep_read_state(g()),()=>{e.set(a,(Array.isArray(g())?g():[g()]).map(n=>{const[s,u]=I(n.orig_name??"");return{...n,filename_stem:s,filename_ext:u}}))}),e.legacy_pre_effect_reset();var O={get value(){return g()},set value(n){g(n),e.flush()},get selectable(){return w()},set selectable(n){w(n),e.flush()},get height(){return t()},set height(n){t(n),e.flush()},get i18n(){return y()},set i18n(n){y(n),e.flush()},get allow_reordering(){return m()},set allow_reordering(n){m(n),e.flush()}};e.init();var B=ve();let T;var Y=e.child(B),R=e.child(Y);return e.each(R,7,()=>e.get(a),n=>n.url,(n,s,u)=>{var p=fe();let C;var G=e.child(p),r=e.child(G);{var b=i=>{var x=ce();e.append(i,x)};e.if(r,i=>{e.deep_read_state(m()),e.get(a),e.untrack(()=>m()&&e.get(a).length>1)&&i(b)})}var U=e.sibling(r,2),S=e.child(U,!0);e.reset(U);var k=e.sibling(U,2),W=e.child(k,!0);e.reset(k),e.reset(G);var j=e.sibling(G),K=e.child(j);{var M=i=>{{let x=e.derived_safe_equal(()=>(e.get(s),e.untrack(()=>L&&window.__is_colab__?null:e.get(s).orig_name)));se(i,{get href(){return e.get(s),e.untrack(()=>e.get(s).url)},get download(){return e.get(x)},$$events:{click:()=>o(e.get(s))},children:(D,E)=>{var V=pe(),ae=e.first_child(V);e.html(ae,()=>(e.get(s),e.deep_read_state($),e.untrack(()=>e.get(s).size!=null?$(e.get(s).size):"(size unknown)"))),e.next(),e.append(D,V)},$$slots:{default:!0}})}},H=i=>{var x=e.text();e.template_effect(D=>e.set_text(x,D),[()=>(e.deep_read_state(y()),e.untrack(()=>y()("file.uploading")))]),e.append(i,x)};e.if(K,i=>{e.get(s),e.untrack(()=>e.get(s).url)?i(M):i(H,!1)})}e.reset(j);var J=e.sibling(j);{var q=i=>{var x=he(),D=e.child(x);e.reset(x),e.event("click",D,()=>{c(e.get(u))}),e.event("keydown",D,E=>{E.key==="Enter"&&c(e.get(u))}),e.append(i,x)};e.if(J,i=>{e.get(a),e.untrack(()=>e.get(a).length>1)&&i(q)})}e.reset(p),e.template_effect(()=>{C=e.set_class(p,1,"file svelte-al0bnp",null,C,{selectable:w(),dragging:e.get(f)===e.get(u),"drop-target":e.get(d)===e.get(u)||e.get(u)===e.get(a).length-1&&e.get(d)===e.get(a).length}),e.set_attribute(p,"data-drop-target",(e.get(d),e.get(a),e.deep_read_state(e.get(u)),e.untrack(()=>e.get(d)===e.get(a).length&&e.get(u)===e.get(a).length-1||e.get(d)===e.get(u)+1?"after":"before"))),e.set_attribute(p,"draggable",(e.deep_read_state(m()),e.get(a),e.untrack(()=>m()&&e.get(a).length>1))),e.set_attribute(G,"aria-label",(e.get(s),e.untrack(()=>e.get(s).orig_name))),e.set_text(S,(e.get(s),e.untrack(()=>e.get(s).filename_stem))),e.set_text(W,(e.get(s),e.untrack(()=>e.get(s).filename_ext)))}),e.event("click",p,i=>{P(i,e.get(u))}),e.event("dragstart",p,i=>_(i,e.get(u))),e.event("dragenter",p,e.preventDefault(function(i){e.bubble_event.call(this,l,i)})),e.event("dragover",p,i=>v(i,e.get(u))),e.event("drop",p,i=>F(i,e.get(u))),e.event("dragend",p,z),e.append(n,p)}),e.reset(R),e.reset(Y),e.reset(B),e.template_effect(()=>T=e.set_style(B,"",T,{"max-height":t()?typeof t()=="number"?t()+"px":t():"auto"})),e.append(A,B),e.pop(O)}var me=e.from_html("<!> <!> <!>",1);function be(A,l){e.push(l,!0);let a=e.prop(l,"buttons",3,null),h=e.prop(l,"on_custom_button_click",3,null);var g=me(),w=e.first_child(g);{var t=_=>{Q(_,{get buttons(){return a()},get on_custom_button_click(){return h()}})};e.if(w,_=>{l.show_label&&a()&&a().length>0&&_(t)})}var y=e.sibling(w,2);{let _=e.derived(()=>l.value===null),v=e.derived(()=>l.label||"File");ee(y,{get show_label(){return l.show_label},get float(){return e.get(_)},get Icon(){return N},get label(){return e.get(v)}})}var m=e.sibling(y,2);{var f=_=>{le(_,{get i18n(){return l.i18n},get selectable(){return l.selectable},get value(){return l.value},get height(){return l.height},$$events:{select(...v){l.on_select?.apply(this,v)},download(...v){l.on_download?.apply(this,v)}}})},d=_=>{oe(_,{unpadded_box:!0,size:"large",children:(v,z)=>{N(v)},$$slots:{default:!0}})};e.if(m,_=>{l.value&&(!Array.isArray(l.value)||l.value.length>0)?_(f):_(d,!1)})}e.append(A,g),e.pop()}var we=e.from_html("<!> <!>",1),ye=e.from_html("<!> <!>",1),ke=e.from_html("<!> <!> <!>",1);function xe(A,l){e.push(l,!1);let a=e.prop(l,"value",12),h=e.prop(l,"label",12),g=e.prop(l,"show_label",12,!0),w=e.prop(l,"file_count",12,"single"),t=e.prop(l,"file_types",12,null),y=e.prop(l,"selectable",12,!1),m=e.prop(l,"root",12),f=e.prop(l,"height",12,void 0),d=e.prop(l,"i18n",12),_=e.prop(l,"max_file_size",12,null),v=e.prop(l,"upload",12),z=e.prop(l,"stream_handler",12),F=e.prop(l,"uploading",12,!1),I=e.prop(l,"allow_reordering",12,!1),P=e.prop(l,"upload_promise",12,null),c=e.prop(l,"buttons",12,null),o=e.prop(l,"on_custom_button_click",12,null);async function L({detail:r}){Array.isArray(a())?a([...a(),...Array.isArray(r)?r:[r]]):a()?a([a(),...Array.isArray(r)?r:[r]]):a(r),await re(),B("change",a()),B("upload",r)}function O(){a(null),B("change",null),B("clear")}const B=te();let T=e.mutable_source(!1);e.legacy_pre_effect(()=>e.get(T),()=>{B("drag",e.get(T))}),e.legacy_pre_effect_reset();var Y={get value(){return a()},set value(r){a(r),e.flush()},get label(){return h()},set label(r){h(r),e.flush()},get show_label(){return g()},set show_label(r){g(r),e.flush()},get file_count(){return w()},set file_count(r){w(r),e.flush()},get file_types(){return t()},set file_types(r){t(r),e.flush()},get selectable(){return y()},set selectable(r){y(r),e.flush()},get root(){return m()},set root(r){m(r),e.flush()},get height(){return f()},set height(r){f(r),e.flush()},get i18n(){return d()},set i18n(r){d(r),e.flush()},get max_file_size(){return _()},set max_file_size(r){_(r),e.flush()},get upload(){return v()},set upload(r){v(r),e.flush()},get stream_handler(){return z()},set stream_handler(r){z(r),e.flush()},get uploading(){return F()},set uploading(r){F(r),e.flush()},get allow_reordering(){return I()},set allow_reordering(r){I(r),e.flush()},get upload_promise(){return P()},set upload_promise(r){P(r),e.flush()},get buttons(){return c()},set buttons(r){c(r),e.flush()},get on_custom_button_click(){return o()},set on_custom_button_click(r){o(r),e.flush()}};e.init();var R=ke(),n=e.first_child(R);{var s=r=>{Q(r,{get buttons(){return c()},get on_custom_button_click(){return o()}})};e.if(n,r=>{e.deep_read_state(g()),e.deep_read_state(c()),e.untrack(()=>g()&&c()&&c().length>0)&&r(s)})}var u=e.sibling(n,2);{let r=e.derived_safe_equal(()=>!a()),b=e.derived_safe_equal(()=>h()||"File");ee(u,{get show_label(){return g()},get Icon(){return N},get float(){return e.get(r)},get label(){return e.get(b)}})}var p=e.sibling(u,2);{var C=r=>{var b=ye(),U=e.first_child(b);{let k=e.derived_safe_equal(()=>c()||[]);Q(U,{get buttons(){return e.get(k)},get on_custom_button_click(){return o()},children:(W,j)=>{var K=we(),M=e.first_child(K);{var H=q=>{{let i=e.derived_safe_equal(()=>(e.deep_read_state(d()),e.untrack(()=>d()("common.upload"))));X(q,{get Icon(){return ie},get label(){return e.get(i)},children:(x,D)=>{Z(x,{icon_upload:!0,get filetype(){return t()},get file_count(){return w()},get max_file_size(){return _()},get root(){return m()},get stream_handler(){return z()},get upload(){return v()},get upload_promise(){return P()},set upload_promise(E){P(E)},get dragging(){return e.get(T)},set dragging(E){e.set(T,E)},get uploading(){return F()},set uploading(E){F(E)},$$events:{load:L,error(E){e.bubble_event.call(this,l,E)}},$$legacy:!0})},$$slots:{default:!0}})}};e.if(M,q=>{e.deep_read_state(w()),e.deep_read_state(a()),e.untrack(()=>!(w()==="single"&&(Array.isArray(a())?a().length>0:a()!==null)))&&q(H)})}var J=e.sibling(M,2);{let q=e.derived_safe_equal(()=>(e.deep_read_state(d()),e.untrack(()=>d()("common.clear"))));X(J,{get Icon(){return ue},get label(){return e.get(q)},$$events:{click:i=>{B("clear"),i.stopPropagation(),O()}}})}e.append(W,K)},$$slots:{default:!0}})}var S=e.sibling(U,2);le(S,{get i18n(){return d()},get selectable(){return y()},get value(){return a()},get height(){return f()},get allow_reordering(){return I()},$$events:{select(k){e.bubble_event.call(this,l,k)},change(k){e.bubble_event.call(this,l,k)},delete(k){e.bubble_event.call(this,l,k)}}}),e.append(r,b)},G=r=>{Z(r,{get filetype(){return t()},get file_count(){return w()},get max_file_size(){return _()},get root(){return m()},get stream_handler(){return z()},get upload(){return v()},get height(){return f()},get upload_promise(){return P()},set upload_promise(b){P(b)},get dragging(){return e.get(T)},set dragging(b){e.set(T,b)},get uploading(){return F()},set uploading(b){F(b)},$$events:{load:L,error(b){e.bubble_event.call(this,l,b)}},children:(b,U)=>{var S=e.comment(),k=e.first_child(S);e.slot(k,l,"default",{},null),e.append(b,S)},$$slots:{default:!0},$$legacy:!0})};e.if(p,r=>{e.deep_read_state(a()),e.untrack(()=>a()&&(Array.isArray(a())?a().length>0:!0))?r(C):r(G,!1)})}return e.append(A,R),e.pop(Y)}var Ae=e.from_html("<!> <!>",1);function Qe(A,l){e.push(l,!0);const a=e.rest_props(l,["$$slots","$$events","$$legacy"]);let h=e.state(void 0),g=e.state(!1);class w extends ne{async get_data(){return e.get(h)&&(await e.get(h),await re()),await super.get_data()}}const t=new w(a);let y=e.state(e.proxy(t.props.value));e.user_effect(()=>{e.get(y)!==t.props.value&&(e.set(y,t.props.value,!0),t.dispatch("change",e.snapshot(t.props.value)))});{let m=e.derived(()=>t.props.value?"solid":"dashed"),f=e.derived(()=>e.get(g)?"focus":"base");ge(A,{get visible(){return t.shared.visible},get variant(){return e.get(m)},get border_mode(){return e.get(f)},padding:!1,get elem_id(){return t.shared.elem_id},get elem_classes(){return t.shared.elem_classes},get container(){return t.shared.container},get scale(){return t.shared.scale},get min_width(){return t.shared.min_width},allow_overflow:!1,children:(d,_)=>{var v=Ae(),z=e.first_child(v);{let c=e.derived(()=>t.shared.loading_status?.status||"complete");_e(z,e.spread_props({get autoscroll(){return t.shared.autoscroll},get i18n(){return t.i18n}},()=>t.shared.loading_status,{get status(){return e.get(c)},on_clear_status:()=>t.dispatch("clear_status",t.shared.loading_status)}))}var F=e.sibling(z,2);{var I=c=>{be(c,{on_select:({detail:o})=>t.dispatch("select",o),on_download:({detail:o})=>t.dispatch("download",o),get selectable(){return t.props._selectable},get value(){return t.props.value},get label(){return t.shared.label},get show_label(){return t.shared.show_label},get height(){return t.props.height},get i18n(){return t.i18n},get buttons(){return t.props.buttons},on_custom_button_click:o=>{t.dispatch("custom_button_click",{id:o})}})},P=c=>{xe(c,{upload:(...o)=>t.shared.client.upload(...o),stream_handler:(...o)=>t.shared.client.stream(...o),get label(){return t.shared.label},get show_label(){return t.shared.show_label},get value(){return t.props.value},get file_count(){return t.props.file_count},get file_types(){return t.props.file_types},get selectable(){return t.props._selectable},get height(){return t.props.height},get root(){return t.shared.root},get allow_reordering(){return t.props.allow_reordering},get max_file_size(){return t.shared.max_file_size},get buttons(){return t.props.buttons},on_custom_button_click:o=>{t.dispatch("custom_button_click",{id:o})},get i18n(){return t.i18n},get upload_promise(){return e.get(h)},set upload_promise(o){e.set(h,o,!0)},$$events:{change:({detail:o})=>{t.props.value=o},drag:({detail:o})=>e.set(g,o,!0),clear:()=>t.dispatch("clear"),select:({detail:o})=>t.dispatch("select",o),upload:()=>t.dispatch("upload"),error:({detail:o})=>{t.shared.loading_status=t.shared.loading_status||{},t.shared.loading_status.status="error",t.dispatch("error",o)},delete:({detail:o})=>{t.dispatch("delete",o)}},children:(o,L)=>{de(o,{get i18n(){return t.i18n},type:"file"})},$$slots:{default:!0}})};e.if(F,c=>{t.shared.interactive?c(P,!1):c(I)})}e.append(d,v)},$$slots:{default:!0}})}e.pop()}export{Ze as BaseExample,be as BaseFile,xe as BaseFileUpload,le as FilePreview,Qe as default};
