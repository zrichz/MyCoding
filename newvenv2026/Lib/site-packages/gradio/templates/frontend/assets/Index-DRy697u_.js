import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import{onMount as pe,createEventDispatcher as de,tick as me}from"./svelte/svelte_svelte.js";import"./i18n-CyvX8KmK.js";import{G as Le}from"./utils.svelte-Ceck75cM.js";import"./svelte/svelte_internal_flags_legacy.js";import{s as ie}from"./select-BigU4G0v.js";import{d as Pe}from"./dispatch-kxCwF96_.js";import{b as xe,d as oe,E as ze,c as Be,I as se,f as Ce,j as ke,D as Ye,l as Xe,B as ve,U as $e}from"./IconButtonWrapper-D4LMIc_2.js";import{F as qe}from"./FullscreenButton-CdZP1GYm.js";import"./index-Dw8Uzof1.js";import{tweened as Ue}from"./svelte/svelte_motion.js";import{U as be}from"./ModifyUpload-2md6CVWe.js";import{S as we}from"./StreamingBar-C6ky6DsM.js";import"./svelte/svelte_store.js";import"./MarkdownCode-C7jLnxqj.js";import"./prism-python-B1e-54E9.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_transition.js";import"./svelte/svelte_events.js";function We(c){let t;for(;t=c.sourceEvent;)c=t;return c}function ye(c,t){if(c=We(c),t===void 0&&(t=c.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var a=r.createSVGPoint();return a.x=c.clientX,a.y=c.clientY,a=a.matrixTransform(t.getScreenCTM().inverse()),[a.x,a.y]}if(t.getBoundingClientRect){var n=t.getBoundingClientRect();return[c.clientX-n.left-t.clientLeft,c.clientY-n.top-t.clientTop]}}return[c.pageX,c.pageY]}const je={passive:!1},ae={capture:!0,passive:!1};function _e(c){c.stopImmediatePropagation()}function re(c){c.preventDefault(),c.stopImmediatePropagation()}function Fe(c){var t=c.document.documentElement,r=ie(c).on("dragstart.drag",re,ae);"onselectstart"in t?r.on("selectstart.drag",re,ae):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Oe(c,t){var r=c.document.documentElement,a=ie(c).on("dragstart.drag",null);t&&(a.on("click.drag",re,ae),setTimeout(function(){a.on("click.drag",null)},0)),"onselectstart"in r?a.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const ne=c=>()=>c;function fe(c,{sourceEvent:t,subject:r,target:a,identifier:n,active:s,x:u,y:o,dx:p,dy:k,dispatch:w}){Object.defineProperties(this,{type:{value:c,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},identifier:{value:n,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:u,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:p,enumerable:!0,configurable:!0},dy:{value:k,enumerable:!0,configurable:!0},_:{value:w}})}fe.prototype.on=function(){var c=this._.on.apply(this._,arguments);return c===this._?this:c};function Ge(c){return!c.ctrlKey&&!c.button}function Ae(){return this.parentNode}function He(c,t){return t??{x:c.x,y:c.y}}function Ne(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ve(){var c=Ge,t=Ae,r=He,a=Ne,n={},s=Pe("start","drag","end"),u=0,o,p,k,w,z=0;function v(i){i.on("mousedown.drag",D).filter(a).on("touchstart.drag",_).on("touchmove.drag",b,je).on("touchend.drag touchcancel.drag",Y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function D(i,m){if(!(w||!c.call(this,i,m))){var y=B(this,t.call(this,i,m),i,m,"mouse");y&&(ie(i.view).on("mousemove.drag",P,ae).on("mouseup.drag",l,ae),Fe(i.view),_e(i),k=!1,o=i.clientX,p=i.clientY,y("start",i))}}function P(i){if(re(i),!k){var m=i.clientX-o,y=i.clientY-p;k=m*m+y*y>z}n.mouse("drag",i)}function l(i){ie(i.view).on("mousemove.drag mouseup.drag",null),Oe(i.view,k),re(i),n.mouse("end",i)}function _(i,m){if(c.call(this,i,m)){var y=i.changedTouches,x=t.call(this,i,m),M=y.length,R,S;for(R=0;R<M;++R)(S=B(this,x,i,m,y[R].identifier,y[R]))&&(_e(i),S("start",i,y[R]))}}function b(i){var m=i.changedTouches,y=m.length,x,M;for(x=0;x<y;++x)(M=n[m[x].identifier])&&(re(i),M("drag",i,m[x]))}function Y(i){var m=i.changedTouches,y=m.length,x,M;for(w&&clearTimeout(w),w=setTimeout(function(){w=null},500),x=0;x<y;++x)(M=n[m[x].identifier])&&(_e(i),M("end",i,m[x]))}function B(i,m,y,x,M,R){var S=s.copy(),h=ye(R||y,m),A,O,C;if((C=r.call(i,new fe("beforestart",{sourceEvent:y,target:v,identifier:M,active:u,x:h[0],y:h[1],dx:0,dy:0,dispatch:S}),x))!=null)return A=C.x-h[0]||0,O=C.y-h[1]||0,function q(f,d,I){var $=h,U;switch(f){case"start":n[M]=q,U=u++;break;case"end":delete n[M],--u;case"drag":h=ye(I||d,m),U=u;break}S.call(f,i,new fe(f,{sourceEvent:d,subject:C,target:v,identifier:M,active:U,x:h[0]+A,y:h[1]+O,dx:h[0]-$[0],dy:h[1]-$[1],dispatch:S}),x)}}return v.filter=function(i){return arguments.length?(c=typeof i=="function"?i:ne(!!i),v):c},v.container=function(i){return arguments.length?(t=typeof i=="function"?i:ne(i),v):t},v.subject=function(i){return arguments.length?(r=typeof i=="function"?i:ne(i),v):r},v.touchable=function(i){return arguments.length?(a=typeof i=="function"?i:ne(!!i),v):a},v.on=function(){var i=s.on.apply(s,arguments);return i===s?v:i},v.clickDistance=function(i){return arguments.length?(z=(i=+i)*i,v):Math.sqrt(z)},v}var Je=e.from_html('<div class="wrap svelte-b2bl92" role="none"><div class="content svelte-b2bl92"><!></div> <div role="none"><span><span class="icon left svelte-b2bl92">◢</span><span class="icon center svelte-b2bl92"></span><span class="icon right svelte-b2bl92">◢</span></span> <div class="inner svelte-b2bl92"></div></div></div>');function Me(c,t){e.push(t,!1);function r(f,d,I){return Math.min(Math.max(f,d),I)}let a=e.prop(t,"position",12,.5),n=e.prop(t,"disabled",12,!1),s=e.prop(t,"slider_color",12,"var(--border-color-primary)"),u=e.prop(t,"image_size",28,()=>({top:0,left:0,width:0,height:0})),o=e.prop(t,"el",12,void 0),p=e.prop(t,"parent_el",12,void 0),k=e.mutable_source(),w=e.mutable_source(0),z=e.mutable_source(!1),v=0;function D(f){v=p()?.getBoundingClientRect().width||0,f===0&&u(u().width=o()?.getBoundingClientRect().width||0,!0),e.set(w,r(u().width*a()+u().left,0,v))}function P(f,d){const I=Math.pow(10,d);return Math.round((f+Number.EPSILON)*I)/I}function l(f){e.set(w,r(f,0,v)),a(P((f-u().left)/u().width,5))}function _(f){n()||(e.set(z,!0),l(f.x))}function b(f){n()||l(f.x)}function Y(){n()||e.set(z,!1)}function B(f){e.set(w,r(u().width*f+u().left,0,v))}pe(()=>{D(u().width);const f=Ve().on("start",_).on("drag",b).on("end",Y);ie(e.get(k)).call(f)}),e.legacy_pre_effect(()=>e.deep_read_state(u()),()=>{D(u().width)}),e.legacy_pre_effect(()=>e.deep_read_state(a()),()=>{B(a())}),e.legacy_pre_effect_reset();var i={get position(){return a()},set position(f){a(f),e.flush()},get disabled(){return n()},set disabled(f){n(f),e.flush()},get slider_color(){return s()},set slider_color(f){s(f),e.flush()},get image_size(){return u()},set image_size(f){u(f),e.flush()},get el(){return o()},set el(f){o(f),e.flush()},get parent_el(){return p()},set parent_el(f){p(f),e.flush()}};e.init();var m=Je();e.event("resize",e.window,()=>D(u().width));var y=e.child(m),x=e.child(y);e.slot(x,t,"default",{},null),e.reset(y),e.bind_this(y,f=>o(f),()=>o());var M=e.sibling(y,2);let R;var S=e.child(M);let h;var A=e.sibling(e.child(S));let O;e.next(),e.reset(S);var C=e.sibling(S,2);let q;return e.reset(M),e.bind_this(M,f=>e.set(k,f),()=>e.get(k)),e.reset(m),e.bind_this(m,f=>p(f),()=>p()),e.template_effect(()=>{R=e.set_class(M,1,"outer svelte-b2bl92",null,R,{disabled:n(),grab:e.get(z)}),e.set_style(M,`transform: translateX(${e.get(w)??""}px)`),h=e.set_class(S,1,"icon-wrap svelte-b2bl92",null,h,{active:e.get(z),disabled:n()}),O=e.set_style(A,"",O,{"--color":s()}),q=e.set_style(C,"",q,{"--color":s()})}),e.append(c,m),e.pop(i)}var Ke=e.from_html("<img/>");function ue(c,t){const r=e.legacy_rest_props(t,["children","$$slots","$$events","$$legacy"]),a=e.legacy_rest_props(r,["src","fullscreen","fixed","transform","img_el","hidden","variant","max_height"]);e.push(t,!1);let n=e.prop(t,"src",12,void 0),s=e.prop(t,"fullscreen",12,!1),u=e.prop(t,"fixed",12,!1),o=e.prop(t,"transform",12,"translate(0px, 0px) scale(1)"),p=e.prop(t,"img_el",12,null),k=e.prop(t,"hidden",12,!1),w=e.prop(t,"variant",12,"upload"),z=e.prop(t,"max_height",12,500);const v=de();function D(_){if(!_)return{top:0,left:0,width:0,height:0};const b=_.parentElement?.getBoundingClientRect();if(!b)return{top:0,left:0,width:0,height:0};const Y=_.naturalWidth/_.naturalHeight,B=b.width/b.height;let i,m;Y>B?(i=b.width,m=b.width/Y):(m=b.height,i=b.height*Y);const y=(b.width-i)/2;return{top:(b.height-m)/2,left:y,width:i,height:m}}pe(()=>{const _=new ResizeObserver(async b=>{for(const Y of b)await me(),v("load",D(p()))});return _.observe(p()),()=>{_.disconnect()}});var P={get src(){return n()},set src(_){n(_),e.flush()},get fullscreen(){return s()},set fullscreen(_){s(_),e.flush()},get fixed(){return u()},set fixed(_){u(_),e.flush()},get transform(){return o()},set transform(_){o(_),e.flush()},get img_el(){return p()},set img_el(_){p(_),e.flush()},get hidden(){return k()},set hidden(_){k(_),e.flush()},get variant(){return w()},set variant(_){w(_),e.flush()},get max_height(){return z()},set max_height(_){z(_),e.flush()}};e.init();var l=Ke();return e.attribute_effect(l,()=>({src:n(),...a,[e.CLASS]:{fixed:u(),hidden:k(),preview:w()==="preview",slider:w()==="upload",fullscreen:s(),small:!s()},[e.STYLE]:{transform:o(),"max-height":z()&&!s()?`${z()}px`:null}}),void 0,void 0,void 0,"svelte-j3ek2n"),e.bind_this(l,_=>p(_),()=>p()),e.replay_events(l),e.event("load",l,()=>v("load",D(p()))),e.append(c,l),e.pop(P)}class Ze{container;image;scale;offsetX;offsetY;isDragging;lastX;lastY;initial_left_padding;initial_top_padding;initial_width;initial_height;subscribers;handleImageLoad;real_image_size={top:0,left:0,width:0,height:0};last_touch_distance;constructor(t,r){this.container=t,this.image=r,this.scale=1,this.offsetX=0,this.offsetY=0,this.isDragging=!1,this.lastX=0,this.lastY=0,this.initial_left_padding=0,this.initial_top_padding=0,this.initial_width=0,this.initial_height=0,this.subscribers=[],this.last_touch_distance=0,this.handleWheel=this.handleWheel.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleImageLoad=this.init.bind(this),this.handleTouchStart=this.handleTouchStart.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this),this.handleTouchEnd=this.handleTouchEnd.bind(this),this.image.addEventListener("load",this.handleImageLoad),this.container.addEventListener("wheel",this.handleWheel),this.container.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),this.container.addEventListener("touchstart",this.handleTouchStart),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("touchend",this.handleTouchEnd),new ResizeObserver(n=>{for(const s of n)s.target===this.container&&(this.handleResize(),this.get_image_size(this.image))}).observe(this.container)}handleResize(){this.init()}init(){const t=this.container.getBoundingClientRect(),r=this.image.getBoundingClientRect();this.initial_left_padding=r.left-t.left,this.initial_top_padding=r.top-t.top,this.initial_width=r.width,this.initial_height=r.height,this.reset_zoom(),this.updateTransform()}reset_zoom(){this.scale=1,this.offsetX=0,this.offsetY=0,this.updateTransform()}handleMouseDown(t){const r=this.image.getBoundingClientRect();if(t.clientX>=r.left&&t.clientX<=r.right&&t.clientY>=r.top&&t.clientY<=r.bottom){if(t.preventDefault(),this.scale===1)return;this.isDragging=!0,this.lastX=t.clientX,this.lastY=t.clientY,this.image.style.cursor="grabbing"}}handleMouseMove(t){if(!this.isDragging)return;const r=t.clientX-this.lastX,a=t.clientY-this.lastY;this.offsetX+=r,this.offsetY+=a,this.lastX=t.clientX,this.lastY=t.clientY,this.updateTransform(),this.updateTransform()}handleMouseUp(){this.isDragging&&(this.constrain_to_bounds(!0),this.updateTransform(),this.isDragging=!1,this.image.style.cursor=this.scale>1?"grab":"zoom-in")}async handleWheel(t){t.preventDefault();const r=this.container.getBoundingClientRect(),a=this.image.getBoundingClientRect();if(t.clientX<a.left||t.clientX>a.right||t.clientY<a.top||t.clientY>a.bottom)return;const n=1.05,s=this.scale,u=-Math.sign(t.deltaY)>0?Math.min(15,s*n):Math.max(1,s/n);if(u===s)return;const o=t.clientX-r.left-this.initial_left_padding,p=t.clientY-r.top-this.initial_top_padding;this.scale=u,this.offsetX=this.compute_new_offset({cursor_position:o,current_offset:this.offsetX,new_scale:u,old_scale:s}),this.offsetY=this.compute_new_offset({cursor_position:p,current_offset:this.offsetY,new_scale:u,old_scale:s}),this.updateTransform(),this.constrain_to_bounds(),this.updateTransform(),this.image.style.cursor=this.scale>1?"grab":"zoom-in"}compute_new_position({position:t,scale:r,anchor_position:a}){return t-(t-a)*(r/this.scale)}compute_new_offset({cursor_position:t,current_offset:r,new_scale:a,old_scale:n}){return t-a/n*(t-r)}constrain_to_bounds(t=!1){if(this.scale===1){this.offsetX=0,this.offsetY=0;return}const r={top:this.real_image_size.top*this.scale+this.offsetY,left:this.real_image_size.left*this.scale+this.offsetX,width:this.real_image_size.width*this.scale,height:this.real_image_size.height*this.scale,bottom:this.real_image_size.top*this.scale+this.offsetY+this.real_image_size.height*this.scale,right:this.real_image_size.left*this.scale+this.offsetX+this.real_image_size.width*this.scale},a=this.real_image_size.left+this.real_image_size.width,n=this.real_image_size.top+this.real_image_size.height;t&&(r.top>this.real_image_size.top?this.offsetY=this.calculate_position(this.real_image_size.top,0,"y"):r.bottom<n&&(this.offsetY=this.calculate_position(n,1,"y")),r.left>this.real_image_size.left?this.offsetX=this.calculate_position(this.real_image_size.left,0,"x"):r.right<a&&(this.offsetX=this.calculate_position(a,1,"x")))}updateTransform(){this.notify({x:this.offsetX,y:this.offsetY,scale:this.scale})}destroy(){this.container.removeEventListener("wheel",this.handleWheel),this.container.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.container.removeEventListener("touchstart",this.handleTouchStart),document.removeEventListener("touchmove",this.handleTouchMove),document.removeEventListener("touchend",this.handleTouchEnd),this.image.removeEventListener("load",this.handleImageLoad)}subscribe(t){this.subscribers.push(t)}unsubscribe(t){this.subscribers=this.subscribers.filter(r=>r!==t)}notify({x:t,y:r,scale:a}){this.subscribers.forEach(n=>n({x:t,y:r,scale:a}))}handleTouchStart(t){t.preventDefault();const r=this.image.getBoundingClientRect(),a=t.touches[0];if(a.clientX>=r.left&&a.clientX<=r.right&&a.clientY>=r.top&&a.clientY<=r.bottom){if(t.touches.length===1&&this.scale>1)this.isDragging=!0,this.lastX=a.clientX,this.lastY=a.clientY;else if(t.touches.length===2){const n=t.touches[0],s=t.touches[1];this.last_touch_distance=Math.hypot(s.clientX-n.clientX,s.clientY-n.clientY)}}}get_image_size(t){if(!t)return;const r=t.parentElement?.getBoundingClientRect();if(!r)return;const a=t.naturalWidth/t.naturalHeight,n=r.width/r.height;let s,u;a>n?(s=r.width,u=r.width/a):(u=r.height,s=r.height*a);const o=(r.width-s)/2,p=(r.height-u)/2;this.real_image_size={top:p,left:o,width:s,height:u}}handleTouchMove(t){if(t.touches.length===1&&this.isDragging){t.preventDefault();const r=t.touches[0],a=r.clientX-this.lastX,n=r.clientY-this.lastY;this.offsetX+=a,this.offsetY+=n,this.lastX=r.clientX,this.lastY=r.clientY,this.updateTransform()}else if(t.touches.length===2){t.preventDefault();const r=t.touches[0],a=t.touches[1],n=Math.hypot(a.clientX-r.clientX,a.clientY-r.clientY);if(this.last_touch_distance===0){this.last_touch_distance=n;return}const s=n/this.last_touch_distance,u=this.scale,o=Math.min(15,Math.max(1,u*s));if(o===u){this.last_touch_distance=n;return}const p=this.container.getBoundingClientRect(),k=(r.clientX+a.clientX)/2-p.left-this.initial_left_padding,w=(r.clientY+a.clientY)/2-p.top-this.initial_top_padding;this.scale=o,this.offsetX=this.compute_new_offset({cursor_position:k,current_offset:this.offsetX,new_scale:o,old_scale:u}),this.offsetY=this.compute_new_offset({cursor_position:w,current_offset:this.offsetY,new_scale:o,old_scale:u}),this.updateTransform(),this.constrain_to_bounds(),this.updateTransform(),this.last_touch_distance=n,this.image.style.cursor=this.scale>1?"grab":"zoom-in"}}handleTouchEnd(t){this.isDragging&&(this.constrain_to_bounds(!0),this.updateTransform(),this.isDragging=!1),t.touches.length===0&&(this.last_touch_distance=0)}calculate_position(t,r,a){if(this.container.getBoundingClientRect(),a==="x"){const n=t,s=this.real_image_size.left+r*this.real_image_size.width;return n-s*this.scale}if(a==="y"){const n=t,s=this.real_image_size.top+r*this.real_image_size.height;return n-s*this.scale}return 0}}var Qe=e.from_html("<!> <!> <!> <!>",1),et=e.from_html("<!> <!>",1),tt=e.from_html('<div class="image-container svelte-1880bc6"><!> <div><!></div></div>'),rt=e.from_html("<!> <!>",1);function st(c,t){e.push(t,!1);const r=()=>e.store_get(h,"$transform",a),[a,n]=e.setup_stores(),s=e.mutable_source(),u=e.mutable_source();let o=e.prop(t,"value",28,()=>[null,null]),p=e.prop(t,"label",12,void 0),k=e.prop(t,"show_download_button",12,!0),w=e.prop(t,"show_label",12),z=e.prop(t,"i18n",12),v=e.prop(t,"position",12),D=e.prop(t,"layer_images",12,!0),P=e.prop(t,"show_single",12,!1),l=e.prop(t,"slider_color",12),_=e.prop(t,"show_fullscreen_button",12,!0),b=e.prop(t,"fullscreen",12,!1),Y=e.prop(t,"buttons",12,null),B=e.prop(t,"on_custom_button_click",12,null),i=e.prop(t,"el_width",12,0),m=e.prop(t,"max_height",12),y=e.prop(t,"interactive",12,!0);const x=de();let M=e.mutable_source(),R=e.mutable_source(),S=e.mutable_source(),h=Ue({x:0,y:0,z:1},{duration:75}),A=e.mutable_source();function O(g,E,L,T,H,N){return(g*L+T-H)/N/E}let C=e.mutable_source(0),q=e.mutable_source(null),f=null;function d(g,E){!g||!E||(e.get(q)?.destroy(),f?.disconnect(),g?.getBoundingClientRect().width,e.set(C,E?.getBoundingClientRect().width||0),e.set(q,new Ze(E,g)),e.get(q).subscribe(({x:L,y:T,scale:H})=>{h.set({x:L,y:T,z:H})}),f=new ResizeObserver(L=>{for(const T of L)T.target===E&&e.set(C,T.contentRect.width),T.target===g&&T.contentRect.width}),f.observe(E),f.observe(g))}pe(()=>()=>{e.get(q)?.destroy(),f?.disconnect()});let I=e.mutable_source(),$=e.mutable_source({top:0,left:0,width:0,height:0});function U(g){e.set($,g.detail)}e.legacy_pre_effect(()=>(e.deep_read_state(v()),e.get(C),e.get($),r()),()=>{e.set(s,O(v(),e.get(C),e.get($).width,e.get($).left,r().x,r().z))}),e.legacy_pre_effect(()=>(e.deep_read_state(D()),e.get(s)),()=>{e.set(u,D()?`clip-path: inset(0 0 0 ${e.get(s)*100}%)`:"")}),e.legacy_pre_effect(()=>(e.get(M),e.get(R)),()=>{d(e.get(M),e.get(R))}),e.legacy_pre_effect_reset();var K={get value(){return o()},set value(g){o(g),e.flush()},get label(){return p()},set label(g){p(g),e.flush()},get show_download_button(){return k()},set show_download_button(g){k(g),e.flush()},get show_label(){return w()},set show_label(g){w(g),e.flush()},get i18n(){return z()},set i18n(g){z(g),e.flush()},get position(){return v()},set position(g){v(g),e.flush()},get layer_images(){return D()},set layer_images(g){D(g),e.flush()},get show_single(){return P()},set show_single(g){P(g),e.flush()},get slider_color(){return l()},set slider_color(g){l(g),e.flush()},get show_fullscreen_button(){return _()},set show_fullscreen_button(g){_(g),e.flush()},get fullscreen(){return b()},set fullscreen(g){b(g),e.flush()},get buttons(){return Y()},set buttons(g){Y(g),e.flush()},get on_custom_button_click(){return B()},set on_custom_button_click(g){B(g),e.flush()},get el_width(){return i()},set el_width(g){i(g),e.flush()},get max_height(){return m()},set max_height(g){m(g),e.flush()},get interactive(){return y()},set interactive(g){y(g),e.flush()}};e.init();var Z=rt(),Q=e.first_child(Z);{let g=e.derived_safe_equal(()=>(e.deep_read_state(p()),e.deep_read_state(z()),e.untrack(()=>p()||z()("image.image"))));xe(Q,{get show_label(){return w()},get Icon(){return oe},get label(){return e.get(g)}})}var le=e.sibling(Q,2);{var ce=g=>{ze(g,{unpadded_box:!0,size:"large",children:(E,L)=>{oe(E)},$$slots:{default:!0}})},he=g=>{var E=tt(),L=e.child(E);Be(L,{get buttons(){return Y()},get on_custom_button_click(){return B()},children:(X,G)=>{var W=Qe(),j=e.first_child(W);{let F=e.derived_safe_equal(()=>(e.deep_read_state(z()),e.untrack(()=>z()("common.undo")))),te=e.derived_safe_equal(()=>(r(),e.untrack(()=>r().z===1)));se(j,{get Icon(){return Ce},get label(){return e.get(F)},get disabled(){return e.get(te)},$$events:{click:()=>e.get(q)?.reset_zoom()}})}var V=e.sibling(j,2);{var J=F=>{qe(F,{get fullscreen(){return b()},$$events:{fullscreen(te){e.bubble_event.call(this,t,te)}}})};e.if(V,F=>{_()&&F(J)})}var ee=e.sibling(V,2);{var Te=F=>{{let te=e.derived_safe_equal(()=>(e.deep_read_state(o()),e.untrack(()=>o()[1]?.url))),Re=e.derived_safe_equal(()=>(e.deep_read_state(o()),e.untrack(()=>o()[1]?.orig_name||"image")));ke(F,{get href(){return e.get(te)},get download(){return e.get(Re)},children:(Se,ft)=>{{let Ie=e.derived_safe_equal(()=>(e.deep_read_state(z()),e.untrack(()=>z()("common.download"))));se(Se,{get Icon(){return Ye},get label(){return e.get(Ie)}})}},$$slots:{default:!0}})}};e.if(ee,F=>{k()&&F(Te)})}var Ee=e.sibling(ee,2);{var De=F=>{se(F,{get Icon(){return Xe},label:"Remove Image",$$events:{click:te=>{o([null,null]),x("clear"),te.stopPropagation()}}})};e.if(Ee,F=>{y()&&F(De)})}e.append(X,W)},$$slots:{default:!0}});var T=e.sibling(L,2);let H;var N=e.child(T);Me(N,{get slider_color(){return l()},get image_size(){return e.get($)},get position(){return v()},set position(X){v(X)},get el(){return e.get(R)},set el(X){e.set(R,X)},get parent_el(){return e.get(A)},set parent_el(X){e.set(A,X)},children:(X,G)=>{var W=et(),j=e.first_child(W);{let J=e.derived_safe_equal(()=>(e.deep_read_state(o()),e.untrack(()=>o()?.[0]?.url)));ue(j,{get src(){return e.get(J)},alt:"",loading:"lazy",variant:"preview",get transform(){return`translate(${r(),e.untrack(()=>r().x)??""}px, ${r(),e.untrack(()=>r().y)??""}px) scale(${r(),e.untrack(()=>r().z)??""})`},get fullscreen(){return b()},get max_height(){return m()},get img_el(){return e.get(M)},set img_el(ee){e.set(M,ee)},$$events:{load:U},$$legacy:!0})}var V=e.sibling(j,2);{let J=e.derived_safe_equal(()=>(e.deep_read_state(o()),e.untrack(()=>!o()?.[1]?.url))),ee=e.derived_safe_equal(()=>(e.deep_read_state(o()),e.untrack(()=>o()?.[1]?.url)));ue(V,{variant:"preview",get fixed(){return D()},get hidden(){return e.get(J)},get src(){return e.get(ee)},alt:"",loading:"lazy",get style(){return`${e.get(u)??""}; background: var(--block-background-fill);`},get transform(){return`translate(${r(),e.untrack(()=>r().x)??""}px, ${r(),e.untrack(()=>r().y)??""}px) scale(${r(),e.untrack(()=>r().z)??""})`},get fullscreen(){return b()},get max_height(){return m()},$$events:{load:U}})}e.append(X,W)},$$slots:{default:!0},$$legacy:!0}),e.reset(T),e.bind_this(T,X=>e.set(I,X),()=>e.get(I)),e.reset(E),e.bind_this(E,X=>e.set(S,X),()=>e.get(S)),e.template_effect(()=>H=e.set_class(T,1,"slider-wrap svelte-1880bc6",null,H,{limit_height:!b()})),e.bind_element_size(T,"clientWidth",i),e.append(g,E)};e.if(le,g=>{e.deep_read_state(o()),e.deep_read_state(P()),e.untrack(()=>(o()===null||o()[0]===null||o()[1]===null)&&!P())?g(ce):g(he,!1)})}e.append(c,Z);var ge=e.pop(K);return n(),ge}var it=e.from_html('<div class="svelte-2ufkjh"><!></div>');function at(c,t){e.push(t,!1);const r=de();e.init();var a=it(),n=e.child(a);se(n,{get Icon(){return Xe},label:"Remove Image",$$events:{click:s=>{r("remove_image"),s.stopPropagation()}}}),e.reset(a),e.append(c,a),e.pop()}var lt=e.from_html('<div class="icon-buttons svelte-1c8zs50"><!></div>'),nt=e.from_html("<div><!></div>"),ot=e.from_html("<div><!></div>"),ut=e.from_html("<div><!> <!></div>"),dt=e.from_html('<!> <div data-testid="image" class="image-container svelte-1c8zs50"><!> <!> <!></div>',1);function ct(c,t){e.push(t,!1);let r=e.prop(t,"value",12),a=e.prop(t,"label",12,void 0),n=e.prop(t,"show_label",12),s=e.prop(t,"root",12),u=e.prop(t,"position",12),o=e.prop(t,"upload_count",12,2),p=e.prop(t,"show_download_button",12,!0),k=e.prop(t,"slider_color",12),w=e.prop(t,"upload",12),z=e.prop(t,"stream_handler",12),v=e.prop(t,"max_file_size",12,null),D=e.prop(t,"i18n",12),P=e.prop(t,"max_height",12),l=e.prop(t,"upload_promise",12,null),_=e.mutable_source(r()||[null,null]),b=e.mutable_source(),Y=e.mutable_source(),B=e.mutable_source();async function i({detail:d},I){const $=[r()[0],r()[1]];d.length>1?$[I]=d[0]:$[I]=d[I],r($),await me(),y("upload",$)}let m=e.mutable_source("");const y=de();let x=e.prop(t,"dragging",12,!1);e.legacy_pre_effect(()=>(e.deep_read_state(r()),e.get(m)),()=>{JSON.stringify(r())!==e.get(m)&&(e.set(m,JSON.stringify(r())),e.set(_,r()))}),e.legacy_pre_effect(()=>e.deep_read_state(x()),()=>{y("drag",x())}),e.legacy_pre_effect_reset();var M={get value(){return r()},set value(d){r(d),e.flush()},get label(){return a()},set label(d){a(d),e.flush()},get show_label(){return n()},set show_label(d){n(d),e.flush()},get root(){return s()},set root(d){s(d),e.flush()},get position(){return u()},set position(d){u(d),e.flush()},get upload_count(){return o()},set upload_count(d){o(d),e.flush()},get show_download_button(){return p()},set show_download_button(d){p(d),e.flush()},get slider_color(){return k()},set slider_color(d){k(d),e.flush()},get upload(){return w()},set upload(d){w(d),e.flush()},get stream_handler(){return z()},set stream_handler(d){z(d),e.flush()},get max_file_size(){return v()},set max_file_size(d){v(d),e.flush()},get i18n(){return D()},set i18n(d){D(d),e.flush()},get max_height(){return P()},set max_height(d){P(d),e.flush()},get upload_promise(){return l()},set upload_promise(d){l(d),e.flush()},get dragging(){return x()},set dragging(d){x(d),e.flush()}};e.init();var R=dt(),S=e.first_child(R);{let d=e.derived_safe_equal(()=>(e.deep_read_state(a()),e.deep_read_state(D()),e.untrack(()=>a()||D()("image.image"))));xe(S,{get show_label(){return n()},get Icon(){return oe},get label(){return e.get(d)}})}var h=e.sibling(S,2),A=e.child(h);{var O=d=>{at(d,{$$events:{remove_image:()=>{u(.5),r([null,null]),y("clear")}}})};e.if(A,d=>{e.deep_read_state(r()),e.untrack(()=>r()?.[0]?.url||r()?.[1]?.url)&&d(O)})}var C=e.sibling(A,2);{var q=d=>{var I=lt(),$=e.child(I);{var U=K=>{{let Z=e.derived_safe_equal(()=>(e.deep_read_state(r()),e.untrack(()=>r()[1].orig_name||"image")));ke(K,{get href(){return e.deep_read_state(r()),e.untrack(()=>r()[1].url)},get download(){return e.get(Z)},children:(Q,le)=>{se(Q,{get Icon(){return Ye}})},$$slots:{default:!0}})}};e.if($,K=>{p()&&K(U)})}e.reset(I),e.append(d,I)};e.if(C,d=>{e.deep_read_state(r()),e.untrack(()=>r()?.[1]?.url)&&d(q)})}var f=e.sibling(C,2);{let d=e.derived_safe_equal(()=>(e.deep_read_state(o()),e.deep_read_state(r()),e.untrack(()=>o()==2||!r()?.[0])));Me(f,{get disabled(){return e.get(d)},get slider_color(){return k()},get position(){return u()},set position(I){u(I)},children:(I,$)=>{var U=ut();let K,Z;var Q=e.child(U);{var le=E=>{var L=nt();let T;var H=e.child(L);{let N=e.derived_safe_equal(()=>(e.deep_read_state(r()),e.untrack(()=>!!r()?.[0])));be(H,{filetype:"image/*",get disable_click(){return e.get(N)},get root(){return s()},file_count:"multiple",get upload(){return w()},get stream_handler(){return z()},get max_file_size(){return v()},get upload_promise(){return l()},set upload_promise(X){l(X)},get dragging(){return x()},set dragging(X){x(X)},$$events:{load:X=>i(X,0)},children:(X,G)=>{var W=e.comment(),j=e.first_child(W);e.slot(j,t,"default",{},null),e.append(X,W)},$$slots:{default:!0},$$legacy:!0})}e.reset(L),e.template_effect(()=>T=e.set_class(L,1,"wrap svelte-1c8zs50",null,T,{"half-wrap":o()===1})),e.append(E,L)},ce=E=>{{let L=e.derived_safe_equal(()=>(e.get(_),e.untrack(()=>e.get(_)[0]?.url)));ue(E,{variant:"upload",get src(){return e.get(L)},alt:"",get max_height(){return P()},get img_el(){return e.get(b)},set img_el(T){e.set(b,T)},$$legacy:!0})}};e.if(Q,E=>{e.get(_),e.untrack(()=>!e.get(_)?.[0])?E(le):E(ce,!1)})}var he=e.sibling(Q,2);{var ge=E=>{{let L=e.derived_safe_equal(()=>(e.deep_read_state(r()),e.untrack(()=>!!r()?.[1])));be(E,{filetype:"image/*",get disable_click(){return e.get(L)},get root(){return s()},file_count:"multiple",get upload(){return w()},get stream_handler(){return z()},get max_file_size(){return v()},get upload_promise(){return l()},set upload_promise(T){l(T)},get dragging(){return x()},set dragging(T){x(T)},$$events:{load:T=>i(T,1)},children:(T,H)=>{var N=e.comment(),X=e.first_child(N);e.slot(X,t,"default",{},null),e.append(T,N)},$$slots:{default:!0},$$legacy:!0})}},g=E=>{var L=e.comment(),T=e.first_child(L);{var H=X=>{var G=ot();let W,j;var V=e.child(G);ze(V,{unpadded_box:!0,size:"large",children:(J,ee)=>{oe(J)},$$slots:{default:!0}}),e.reset(G),e.template_effect(()=>{W=e.set_class(G,1,"empty-wrap fixed svelte-1c8zs50",null,W,{"white-icon":!r()?.[0]?.url}),j=e.set_style(G,"",j,{width:`${e.get(Y)*(1-u())}px`,transform:`translateX(${e.get(Y)*u()}px)`})}),e.append(X,G)},N=X=>{var G=e.comment(),W=e.first_child(G);{var j=V=>{{let J=e.derived_safe_equal(()=>o()===1);ue(V,{variant:"upload",get src(){return e.get(_),e.untrack(()=>e.get(_)[1].url)},alt:"",get fixed(){return e.get(J)},transform:"translate(0px, 0px) scale(1)",get max_height(){return P()}})}};e.if(W,V=>{e.get(_),e.untrack(()=>e.get(_)?.[1])&&V(j)},!0)}e.append(X,G)};e.if(T,X=>{e.get(_),e.deep_read_state(o()),e.untrack(()=>!e.get(_)?.[1]&&o()===1)?X(H):X(N,!1)},!0)}e.append(E,L)};e.if(he,E=>{e.get(_),e.deep_read_state(o()),e.untrack(()=>!e.get(_)?.[1]&&o()===2)?E(ge):E(g,!1)})}e.reset(U),e.template_effect(()=>{K=e.set_class(U,1,"upload-wrap svelte-1c8zs50",null,K,{"side-by-side":o()===2}),Z=e.set_style(U,"",Z,{display:o()===2?"flex":"block"})}),e.append(I,U)},$$slots:{default:!0},$$legacy:!0})}return e.reset(h),e.bind_element_size(h,"clientWidth",d=>e.set(Y,d)),e.bind_element_size(h,"clientHeight",d=>e.set(B,d)),e.append(c,R),e.pop(M)}function ht(c,t){e.push(t,!1);let r=e.prop(t,"value",28,()=>[null,null]),a=e.prop(t,"upload",12),n=e.prop(t,"stream_handler",12),s=e.prop(t,"label",12),u=e.prop(t,"show_label",12),o=e.prop(t,"i18n",12),p=e.prop(t,"root",12),k=e.prop(t,"upload_count",12,1),w=e.prop(t,"dragging",12),z=e.prop(t,"max_height",12),v=e.prop(t,"max_file_size",12,null),D=e.prop(t,"upload_promise",12,null);var P={get value(){return r()},set value(l){r(l),e.flush()},get upload(){return a()},set upload(l){a(l),e.flush()},get stream_handler(){return n()},set stream_handler(l){n(l),e.flush()},get label(){return s()},set label(l){s(l),e.flush()},get show_label(){return u()},set show_label(l){u(l),e.flush()},get i18n(){return o()},set i18n(l){o(l),e.flush()},get root(){return p()},set root(l){p(l),e.flush()},get upload_count(){return k()},set upload_count(l){k(l),e.flush()},get dragging(){return w()},set dragging(l){w(l),e.flush()},get max_height(){return z()},set max_height(l){z(l),e.flush()},get max_file_size(){return v()},set max_file_size(l){v(l),e.flush()},get upload_promise(){return D()},set upload_promise(l){D(l),e.flush()}};return ct(c,{slider_color:"var(--border-color-primary)",position:.5,get root(){return p()},get label(){return s()},get show_label(){return u()},get upload_count(){return k()},get stream_handler(){return n()},get upload(){return a()},get max_file_size(){return v()},get max_height(){return z()},get i18n(){return o()},get upload_promise(){return D()},set upload_promise(l){D(l)},get value(){return r()},set value(l){r(l)},get dragging(){return w()},set dragging(l){w(l)},$$events:{edit(l){e.bubble_event.call(this,t,l)},clear(l){e.bubble_event.call(this,t,l)},stream(l){e.bubble_event.call(this,t,l)},drag:({detail:l})=>w(l),upload(l){e.bubble_event.call(this,t,l)},select(l){e.bubble_event.call(this,t,l)},share(l){e.bubble_event.call(this,t,l)}},children:(l,_)=>{var b=e.comment(),Y=e.first_child(b);e.slot(Y,t,"default",{},null),e.append(l,b)},$$slots:{default:!0},$$legacy:!0}),e.pop(P)}var gt=e.from_html("<!> <!>",1),_t=e.from_html("<!> <!>",1);function Ft(c,t){e.push(t,!0);let r=e.state(void 0);class a extends Le{async get_data(){return e.get(r)&&(await e.get(r),await me()),await super.get_data()}}const n=e.rest_props(t,["$$slots","$$events","$$legacy"]),s=new a(n);let u=e.state(e.proxy(s.props.value)),o=e.state(!1),p=e.state(!1),k,w=e.derived(()=>Math.max(0,Math.min(100,s.props.slider_position))/100);e.user_effect(()=>{e.get(u)!=s.props.value&&(e.set(u,s.props.value,!0),s.dispatch("change"),s.dispatch("input"))});const z=b=>{const Y=b;Y.preventDefault(),Y.stopPropagation(),Y.type==="dragenter"||Y.type==="dragover"?e.set(p,!0):Y.type==="dragleave"&&e.set(p,!1)},v=b=>{if(s.shared.interactive){const Y=b;Y.preventDefault(),Y.stopPropagation(),e.set(p,!1),k&&k.loadFilesFromDrop(Y)}};var D=e.comment(),P=e.first_child(D);{var l=b=>{{let Y=e.derived(()=>e.get(p)?"focus":"base"),B=e.derived(()=>s.props.height||void 0);ve(b,{get visible(){return s.shared.visible},variant:"solid",get border_mode(){return e.get(Y)},padding:!1,get elem_id(){return s.shared.elem_id},get elem_classes(){return s.shared.elem_classes},get height(){return e.get(B)},get width(){return s.props.width},allow_overflow:!1,get container(){return s.shared.container},get scale(){return s.shared.scale},get min_width(){return s.shared.min_width},get fullscreen(){return e.get(o)},set fullscreen(i){e.set(o,i,!0)},children:(i,m)=>{var y=gt(),x=e.first_child(y);we(x,e.spread_props({get autoscroll(){return s.shared.autoscroll},get i18n(){return s.i18n}},()=>s.shared.loading_status));var M=e.sibling(x,2);{let R=e.derived(()=>s.props.buttons.some(h=>typeof h=="string"&&h==="download")),S=e.derived(()=>s.props.buttons.some(h=>typeof h=="string"&&h==="fullscreen"));st(M,{get fullscreen(){return e.get(o)},get interactive(){return s.shared.interactive},get label(){return s.shared.label},get show_label(){return s.shared.show_label},get show_download_button(){return e.get(R)},get i18n(){return s.i18n},get show_fullscreen_button(){return e.get(S)},get buttons(){return s.props.buttons},on_custom_button_click:h=>{s.dispatch("custom_button_click",{id:h})},get position(){return e.get(w)},get slider_color(){return s.props.slider_color},get max_height(){return s.props.max_height},get value(){return s.props.value},set value(h){s.props.value=h},$$events:{select:({detail:h})=>s.dispatch("select",h),share:({detail:h})=>s.dispatch("share",h),error:({detail:h})=>s.dispatch("error",h),clear:()=>s.dispatch("clear"),fullscreen:({detail:h})=>{e.set(o,h,!0)}}})}e.append(i,y)},$$slots:{default:!0}})}},_=b=>{{let Y=e.derived(()=>s.props.value===null?"dashed":"solid"),B=e.derived(()=>e.get(p)?"focus":"base"),i=e.derived(()=>s.props.height||void 0);ve(b,{get visible(){return s.shared.visible},get variant(){return e.get(Y)},get border_mode(){return e.get(B)},padding:!1,get elem_id(){return s.shared.elem_id},get elem_classes(){return s.shared.elem_classes},get height(){return e.get(i)},get width(){return s.props.width},allow_overflow:!1,get container(){return s.shared.container},get scale(){return s.shared.scale},get min_width(){return s.shared.min_width},$$events:{dragenter:z,dragleave:z,dragover:z,drop:v},children:(m,y)=>{var x=_t(),M=e.first_child(x);we(M,e.spread_props({get autoscroll(){return s.shared.autoscroll},get i18n(){return s.i18n}},()=>s.shared.loading_status,{on_clear_status:()=>s.dispatch("clear_status",s.shared.loading_status)}));var R=e.sibling(M,2);{let S=e.derived(()=>s.shared.client?.stream);e.bind_this(ht(R,{get root(){return s.shared.root},get label(){return s.shared.label},get show_label(){return s.shared.show_label},get upload_count(){return s.props.upload_count},get max_file_size(){return s.shared.max_file_size},get i18n(){return s.i18n},upload:(...h)=>s.shared.client.upload(...h),get stream_handler(){return e.get(S)},get max_height(){return s.props.max_height},get upload_promise(){return e.get(r)},set upload_promise(h){e.set(r,h,!0)},get value(){return s.props.value},set value(h){s.props.value=h},get dragging(){return e.get(p)},set dragging(h){e.set(p,h,!0)},$$events:{edit:()=>s.dispatch("edit"),clear:()=>{s.dispatch("clear")},drag:({detail:h})=>e.set(p,h,!0),upload:()=>s.dispatch("upload"),error:({detail:h})=>{s.shared.loading_status&&(s.shared.loading_status.status="error"),s.dispatch("error",h)},close_stream:()=>{s.dispatch("close_stream","stream")}},children:(h,A)=>{var O=e.comment(),C=e.first_child(O);{var q=f=>{$e(f,{get i18n(){return s.i18n},type:"image",get placeholder(){return s.props.placeholder}})};e.if(C,f=>{f(q)})}e.append(h,O)},$$slots:{default:!0}}),h=>k=h,()=>k)}e.append(m,x)},$$slots:{default:!0}})}};e.if(P,b=>{!s.shared.interactive||s.props.value?.[1]&&s.props.value?.[0]?b(l):b(_,!1)})}e.append(c,D),e.pop()}export{Ft as default};
